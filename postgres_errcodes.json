{
  "metadata": {
    "title": "PostgreSQL Error Code Catalog for RCA Automation",
    "version": "PostgreSQL 17",
    "copyright":"Copyright 2025 Beta ORI Inc. Canada, All Rights Reserved.",
    "Author":"Awase Khirni Syed",
    "total_error_codes": 397,
    "generated_date": "2025-05-06",
    "source": "https://www.postgresql.org/docs/current/errcodes-appendix.html",
    "rca_schema_version": "2.0",
    "description": "Machine-readable catalog of all PostgreSQL error codes with root cause analysis, remediation guidance, and severity classification"
  },
  "error_classes": {
    "00": {"name": "Successful Completion", "severity": "SUCCESS"},
    "01": {"name": "Warning", "severity": "WARNING"},
    "02": {"name": "No Data", "severity": "WARNING"},
    "03": {"name": "SQL Statement Not Yet Complete", "severity": "ERROR"},
    "08": {"name": "Connection Exception", "severity": "FATAL"},
    "09": {"name": "Triggered Action Exception", "severity": "ERROR"},
    "0A": {"name": "Feature Not Supported", "severity": "ERROR"},
    "0B": {"name": "Invalid Transaction Initiation", "severity": "ERROR"},
    "0F": {"name": "Locator Exception", "severity": "ERROR"},
    "0L": {"name": "Invalid Grantor", "severity": "ERROR"},
    "0P": {"name": "Invalid Role Specification", "severity": "ERROR"},
    "0Z": {"name": "Diagnostics Exception", "severity": "ERROR"},
    "10": {"name": "XQuery Error", "severity": "ERROR"},
    "20": {"name": "Case Not Found", "severity": "ERROR"},
    "21": {"name": "Cardinality Violation", "severity": "ERROR"},
    "22": {"name": "Data Exception", "severity": "ERROR"},
    "23": {"name": "Integrity Constraint Violation", "severity": "ERROR"},
    "24": {"name": "Invalid Cursor State", "severity": "ERROR"},
    "25": {"name": "Invalid Transaction State", "severity": "ERROR"},
    "26": {"name": "Invalid SQL Statement Name", "severity": "ERROR"},
    "27": {"name": "Triggered Data Change Violation", "severity": "ERROR"},
    "28": {"name": "Invalid Authorization Specification", "severity": "ERROR"},
    "2B": {"name": "Dependent Privilege Descriptors Still Exist", "severity": "ERROR"},
    "2D": {"name": "Invalid Transaction Termination", "severity": "ERROR"},
    "2F": {"name": "SQL Routine Exception", "severity": "ERROR"},
    "34": {"name": "Invalid Cursor Name", "severity": "ERROR"},
    "38": {"name": "External Routine Exception", "severity": "ERROR"},
    "39": {"name": "External Routine Invocation Exception", "severity": "ERROR"},
    "3B": {"name": "Savepoint Exception", "severity": "ERROR"},
    "3D": {"name": "Invalid Catalog Name", "severity": "ERROR"},
    "3F": {"name": "Invalid Schema Name", "severity": "ERROR"},
    "40": {"name": "Transaction Rollback", "severity": "ERROR"},
    "42": {"name": "Syntax Error or Access Rule Violation", "severity": "ERROR"},
    "44": {"name": "WITH CHECK OPTION Violation", "severity": "ERROR"},
    "53": {"name": "Insufficient Resources", "severity": "FATAL"},
    "54": {"name": "Program Limit Exceeded", "severity": "ERROR"},
    "55": {"name": "Object Not In Prerequisite State", "severity": "ERROR"},
    "57": {"name": "Operator Intervention", "severity": "ERROR"},
    "58": {"name": "System Error", "severity": "FATAL"},
    "F0": {"name": "Configuration File Error", "severity": "FATAL"},
    "HV": {"name": "Foreign Data Wrapper Error", "severity": "ERROR"},
    "P0": {"name": "PL/pgSQL Error", "severity": "ERROR"},
    "XX": {"name": "Internal Error", "severity": "PANIC"}
  },
  "error_codes": [
    {
      "sqlstate": "00000",
      "class": "00",
      "class_name": "Successful Completion",
      "condition_name": "successful_completion",
      "severity": "SUCCESS",
      "description": "Operation completed successfully without errors",
      "root_cause": "Normal successful execution of SQL statement or transaction",
      "remediation": "No action required - operation succeeded",
      "common_scenarios": ["COMMIT after successful transaction", "Successful DML operations", "Query execution with results"],
      "rca_priority": "NONE",
      "monitoring_recommendation": "Log for audit trail only"
    },
    {
      "sqlstate": "01000",
      "class": "01",
      "class_name": "Warning",
      "condition_name": "warning",
      "severity": "WARNING",
      "description": "General warning condition",
      "root_cause": "Non-critical issue detected that doesn't prevent statement execution",
      "remediation": "Review application logs for warning details; may indicate suboptimal usage patterns",
      "common_scenarios": ["Implicit type coercion", "Deprecated feature usage", "Non-fatal data truncation"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Aggregate warnings for trend analysis"
    },
    {
      "sqlstate": "0100C",
      "class": "01",
      "class_name": "Warning",
      "condition_name": "dynamic_result_sets_returned",
      "severity": "WARNING",
      "description": "Dynamic result sets were returned by a procedure",
      "root_cause": "Stored procedure returned multiple result sets when caller expected single result",
      "remediation": "Update client code to handle multiple result sets; verify procedure logic matches expectations",
      "common_scenarios": ["PL/pgSQL functions with multiple RETURN QUERY statements", "Procedures returning dynamic cursors"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Track in application logs"
    },
    {
      "sqlstate": "01008",
      "class": "01",
      "class_name": "Warning",
      "condition_name": "implicit_zero_bit_padding",
      "severity": "WARNING",
      "description": "Implicit zero-bit padding occurred during bit string operations",
      "root_cause": "Bit string operations required padding to match operand lengths",
      "remediation": "Explicitly pad bit strings in application logic to avoid implicit behavior",
      "common_scenarios": ["Bitwise operations on mismatched-length bit strings", "BIT VARYING comparisons"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Log for debugging only"
    },
    {
      "sqlstate": "01003",
      "class": "01",
      "class_name": "Warning",
      "condition_name": "null_value_eliminated_in_set_function",
      "severity": "WARNING",
      "description": "NULL value eliminated in set function (aggregate)",
      "root_cause": "Aggregate function (e.g., SUM, AVG) encountered NULL values which were automatically excluded",
      "remediation": "Use COALESCE() to handle NULLs explicitly if business logic requires different behavior",
      "common_scenarios": ["SUM(column) where column contains NULLs", "AVG() on sparse datasets", "COUNT(*) vs COUNT(column) confusion"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Alert if unexpected NULL elimination in critical calculations"
    },
    {
      "sqlstate": "01007",
      "class": "01",
      "class_name": "Warning",
      "condition_name": "privilege_not_granted",
      "severity": "WARNING",
      "description": "Requested privilege was not granted (non-fatal)",
      "root_cause": "GRANT statement attempted to grant privilege user already possesses",
      "remediation": "Verify current privileges with \\dp before granting; suppress warning if intentional",
      "common_scenarios": ["Idempotent GRANT scripts", "Role synchronization routines"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Ignore in automated deployment scripts"
    },
    {
      "sqlstate": "01006",
      "class": "01",
      "class_name": "Warning",
      "condition_name": "privilege_not_revoked",
      "severity": "WARNING",
      "description": "Requested privilege was not revoked (non-fatal)",
      "root_cause": "REVOKE statement attempted to revoke privilege user didn't possess",
      "remediation": "Verify current privileges before revoking; suppress warning if intentional",
      "common_scenarios": ["Idempotent REVOKE scripts", "Cleanup routines after role changes"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Ignore in automated deployment scripts"
    },
    {
      "sqlstate": "01004",
      "class": "01",
      "class_name": "Warning",
      "condition_name": "string_data_right_truncation",
      "severity": "WARNING",
      "description": "String data right truncation occurred",
      "root_cause": "Source string longer than target column/variable; truncated without error due to context",
      "remediation": "Increase target column width or validate input length before insertion; use STRICT mode in functions",
      "common_scenarios": ["INSERT into VARCHAR(n) with longer source", "Implicit casts in function parameters", "ETL pipeline with unvalidated inputs"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Alert on production data ingestion pipelines"
    },
    {
      "sqlstate": "01P01",
      "class": "01",
      "class_name": "Warning",
      "condition_name": "deprecated_feature",
      "severity": "WARNING",
      "description": "Use of deprecated PostgreSQL feature detected",
      "root_cause": "Application using feature scheduled for removal in future PostgreSQL versions",
      "remediation": "Migrate to recommended alternative before next major version upgrade; check release notes",
      "common_scenarios": ["Legacy syntax usage", "Deprecated GUC parameters", "Old extension APIs"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Track for upgrade planning"
    },
    {
      "sqlstate": "02000",
      "class": "02",
      "class_name": "No Data",
      "condition_name": "no_data",
      "severity": "WARNING",
      "description": "Query returned no data rows",
      "root_cause": "SELECT statement or cursor fetch returned zero rows matching criteria",
      "remediation": "Handle empty result sets in application logic; verify query predicates; implement NOT FOUND exception handling in PL/pgSQL",
      "common_scenarios": ["SELECT with non-matching WHERE clause", "FETCH from exhausted cursor", "Application expecting data that doesn't exist"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Log for business logic validation"
    },
    {
      "sqlstate": "02001",
      "class": "02",
      "class_name": "No Data",
      "condition_name": "no_additional_dynamic_result_sets_returned",
      "severity": "WARNING",
      "description": "No additional dynamic result sets available",
      "root_cause": "Application requested more result sets than procedure actually returned",
      "remediation": "Check procedure documentation for expected number of result sets; implement proper result set iteration",
      "common_scenarios": ["Multiple cursor fetches after final result set exhausted"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Application-level handling"
    },
    {
      "sqlstate": "03000",
      "class": "03",
      "class_name": "SQL Statement Not Yet Complete",
      "condition_name": "sql_statement_not_yet_complete",
      "severity": "ERROR",
      "description": "SQL statement syntax is incomplete",
      "root_cause": "Client sent partial SQL statement (e.g., missing semicolon or continuation)",
      "remediation": "Complete the SQL statement syntax before execution; check for unterminated strings/quotes; validate client library behavior",
      "common_scenarios": ["Interactive psql sessions with incomplete statements", "Network interruption during query transmission", "Malformed multi-statement queries"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Block at application gateway layer"
    },
    {
      "sqlstate": "08000",
      "class": "08",
      "class_name": "Connection Exception",
      "condition_name": "connection_exception",
      "severity": "FATAL",
      "description": "Generic connection exception",
      "root_cause": "Network failure, authentication issue, or server unavailability prevented connection establishment",
      "remediation": "Verify network connectivity, PostgreSQL server status, authentication credentials, and pg_hba.conf settings; implement connection retry with exponential backoff",
      "common_scenarios": ["Network partition", "Firewall blocking port 5432", "Server crash during connection attempt", "DNS resolution failure"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Immediate alert; correlate with infrastructure metrics"
    },
    {
      "sqlstate": "08003",
      "class": "08",
      "class_name": "Connection Exception",
      "condition_name": "connection_does_not_exist",
      "severity": "FATAL",
      "description": "Connection does not exist or was terminated",
      "root_cause": "Client attempted operation on closed/terminated connection; server killed backend process via pg_terminate_backend() or timeout",
      "remediation": "Implement connection validation before use; add retry logic with exponential backoff; monitor idle_in_transaction_session_timeout; use connection pool health checks",
      "common_scenarios": ["Connection pool stale connections", "Server-side termination", "Network timeout", "Load balancer idle timeout"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Alert on connection churn rate spikes"
    },
    {
      "sqlstate": "08006",
      "class": "08",
      "class_name": "Connection Exception",
      "condition_name": "connection_failure",
      "severity": "FATAL",
      "description": "Connection failure during communication",
      "root_cause": "TCP connection reset, server crash, or unexpected termination during active session",
      "remediation": "Implement robust connection retry logic; monitor server health; check system logs for OOM killer or segfaults; validate network stability",
      "common_scenarios": ["Server OOM crash", "Network interface failure", "Unexpected PostgreSQL restart", "TCP RST packet"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Immediate alert; correlate with host metrics"
    },
    {
      "sqlstate": "08001",
      "class": "08",
      "class_name": "Connection Exception",
      "condition_name": "sqlclient_unable_to_establish_sqlconnection",
      "severity": "FATAL",
      "description": "SQL client unable to establish SQL connection",
      "root_cause": "Client-side failure to initiate connection (DNS resolution failure, invalid hostname, client library bug)",
      "remediation": "Verify hostname resolution; check client library version compatibility; validate connection string syntax; test connectivity with psql",
      "common_scenarios": ["Invalid hostname in connection string", "DNS failure", "Client firewall blocking outbound connections", "Misconfigured service discovery"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Alert with client-side diagnostics"
    },
    {
      "sqlstate": "08004",
      "class": "08",
      "class_name": "Connection Exception",
      "condition_name": "sqlserver_rejected_establishment_of_sqlconnection",
      "severity": "FATAL",
      "description": "SQL server rejected connection establishment",
      "root_cause": "Server actively rejected connection due to authentication failure, connection limit exceeded, or pg_hba.conf denial",
      "remediation": "Check PostgreSQL logs for rejection reason; verify max_connections setting; review pg_hba.conf rules; validate credentials; implement connection pooling",
      "common_scenarios": ["max_connections exceeded", "pg_hba.conf reject rule match", "Invalid password/authentication method mismatch", "IP whitelist rejection"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Immediate alert; correlate with pg_stat_activity"
    },
    {
      "sqlstate": "08007",
      "class": "08",
      "class_name": "Connection Exception",
      "condition_name": "transaction_resolution_unknown",
      "severity": "FATAL",
      "description": "Transaction resolution unknown after connection failure",
      "root_cause": "Connection lost during transaction commit/rollback; client cannot determine transaction outcome",
      "remediation": "Implement idempotent operations; use transaction IDs for reconciliation; design for at-least-once semantics; avoid long-running transactions over unstable networks",
      "common_scenarios": ["Network partition during COMMIT", "Server crash mid-transaction", "Client timeout during 2PC", "Mobile client connectivity loss"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Critical business transaction alert"
    },
    {
      "sqlstate": "08P01",
      "class": "08",
      "class_name": "Connection Exception",
      "condition_name": "protocol_violation",
      "severity": "FATAL",
      "description": "Frontend/backend protocol violation detected",
      "root_cause": "Client sent malformed protocol messages; version mismatch between client and server; driver bug; proxy mangling traffic",
      "remediation": "Update client driver to compatible version; verify no proxy/firewall is mangling traffic; check for driver bugs; validate TLS termination configuration",
      "common_scenarios": ["Outdated JDBC/ODBC driver", "Malicious traffic injection", "Proxy modifying PostgreSQL protocol", "TLS handshake failure"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Security alert; block suspicious clients"
    },
    {
      "sqlstate": "09000",
      "class": "09",
      "class_name": "Triggered Action Exception",
      "condition_name": "triggered_action_exception",
      "severity": "ERROR",
      "description": "Triggered action exception",
      "root_cause": "Trigger or rule action encountered an error during execution",
      "remediation": "Review trigger function logic; check for exceptions in trigger body; validate trigger dependencies",
      "common_scenarios": ["Trigger function raising exception", "Missing dependencies in trigger", "Recursive trigger causing stack overflow"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Alert with trigger name and table context"
    },
    {
      "sqlstate": "0A000",
      "class": "0A",
      "class_name": "Feature Not Supported",
      "condition_name": "feature_not_supported",
      "severity": "ERROR",
      "description": "Feature not supported by PostgreSQL",
      "root_cause": "Application attempted to use SQL feature not implemented in PostgreSQL (e.g., certain SQL:2003 features)",
      "remediation": "Use PostgreSQL-native alternatives; check documentation for supported features; refactor application logic",
      "common_scenarios": ["Application designed for Oracle/SQL Server using non-standard features", "ORM generating unsupported SQL constructs", "Cross-database compatibility layer issues"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Track for application compatibility assessment"
    },
    {
      "sqlstate": "0B000",
      "class": "0B",
      "class_name": "Invalid Transaction Initiation",
      "condition_name": "invalid_transaction_initiation",
      "severity": "ERROR",
      "description": "Invalid transaction initiation",
      "root_cause": "Attempt to start transaction in invalid context (e.g., within another transaction in non-nested mode)",
      "remediation": "Review transaction management logic; avoid explicit BEGIN/COMMIT in contexts that already manage transactions (e.g., connection pools)",
      "common_scenarios": ["Nested transactions without SAVEPOINT", "ORM transaction management conflict", "Connection pool auto-commit interference"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Application logic review required"
    },
    {
      "sqlstate": "0F000",
      "class": "0F",
      "class_name": "Locator Exception",
      "condition_name": "locator_exception",
      "severity": "ERROR",
      "description": "Locator exception",
      "root_cause": "Error related to SQL locators (used for large objects or external data references)",
      "remediation": "Validate locator references; ensure large objects exist before access; check fdw_table_references integrity",
      "common_scenarios": ["Dangling large object reference", "FDW locator pointing to non-existent remote object"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Log with object identifier context"
    },
    {
      "sqlstate": "0F001",
      "class": "0F",
      "class_name": "Locator Exception",
      "condition_name": "invalid_locator_specification",
      "severity": "ERROR",
      "description": "Invalid locator specification",
      "root_cause": "Malformed or invalid locator reference provided to SQL operation",
      "remediation": "Validate locator format before use; ensure proper creation via LO_CREAT or FDW mechanisms",
      "common_scenarios": ["Corrupted locator value", "Manual manipulation of locator internals"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Application validation required"
    },
    {
      "sqlstate": "0L000",
      "class": "0L",
      "class_name": "Invalid Grantor",
      "condition_name": "invalid_grantor",
      "severity": "ERROR",
      "description": "Invalid grantor specified",
      "root_cause": "GRANT statement specified non-existent or unauthorized grantor role",
      "remediation": "Verify grantor role exists and has required privileges; check role membership hierarchy",
      "common_scenarios": ["GRANT ... GRANTED BY non_existent_role", "Role dropped after grant preparation"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Schema change audit log"
    },
    {
      "sqlstate": "0LP01",
      "class": "0L",
      "class_name": "Invalid Grantor",
      "condition_name": "invalid_grant_operation",
      "severity": "ERROR",
      "description": "Invalid grant operation",
      "root_cause": "Attempted grant operation violates privilege model (e.g., granting privilege not possessed WITH GRANT OPTION)",
      "remediation": "Verify grantor possesses privilege WITH GRANT OPTION; review role privilege hierarchy",
      "common_scenarios": ["Granting without GRANT OPTION", "Circular privilege delegation"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Security audit log"
    },
    {
      "sqlstate": "0P000",
      "class": "0P",
      "class_name": "Invalid Role Specification",
      "condition_name": "invalid_role_specification",
      "severity": "ERROR",
      "description": "Invalid role specification",
      "root_cause": "Role name does not exist or is invalid in current context",
      "remediation": "Verify role exists with \\du; check for case sensitivity with quoted identifiers; validate role in current database",
      "common_scenarios": ["Typo in role name", "Role exists in different database", "Case-sensitive role name mismatch"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Security configuration audit"
    },
    {
      "sqlstate": "0Z000",
      "class": "0Z",
      "class_name": "Diagnostics Exception",
      "condition_name": "diagnostics_exception",
      "severity": "ERROR",
      "description": "Diagnostics exception",
      "root_cause": "Error in SQL diagnostics area (GET DIAGNOSTICS statement)",
      "remediation": "Review GET DIAGNOSTICS usage; verify diagnostic item names; check PL/pgSQL exception block context",
      "common_scenarios": ["Invalid diagnostic item name", "GET DIAGNOSTICS outside exception handler"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "PL/pgSQL debugging"
    },
    {
      "sqlstate": "0Z002",
      "class": "0Z",
      "class_name": "Diagnostics Exception",
      "condition_name": "stacked_diagnostics_accessed_without_active_handler",
      "severity": "ERROR",
      "description": "Stacked diagnostics accessed without active handler",
      "root_cause": "GET STACKED DIAGNOSTICS used outside exception handler block",
      "remediation": "Ensure GET STACKED DIAGNOSTICS is only used within EXCEPTION block in PL/pgSQL",
      "common_scenarios": ["Misplaced GET STACKED DIAGNOSTICS in function body", "Copy-paste error from exception handler"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Code review required"
    },
    {
      "sqlstate": "20000",
      "class": "20",
      "class_name": "Case Not Found",
      "condition_name": "case_not_found",
      "severity": "ERROR",
      "description": "CASE not found for CASE statement",
      "root_cause": "Searched CASE statement had no matching WHEN clause and no ELSE clause",
      "remediation": "Add ELSE clause to CASE statement; validate input values cover all expected cases",
      "common_scenarios": ["Incomplete business logic coverage", "New enum values not handled in CASE", "Data quality issues causing unexpected values"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Alert on unhandled business cases"
    },
    {
      "sqlstate": "21000",
      "class": "21",
      "class_name": "Cardinality Violation",
      "condition_name": "cardinality_violation",
      "severity": "ERROR",
      "description": "Cardinality violation",
      "root_cause": "Subquery returned more than one row where single row expected (e.g., in scalar context)",
      "remediation": "Use LIMIT 1 with ORDER BY for deterministic selection; validate subquery returns single row; refactor to JOIN if multiple rows expected",
      "common_scenarios": ["Scalar subquery in SELECT returning multiple rows", "Correlated subquery without proper filtering", "Application assuming uniqueness not enforced by schema"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Query pattern analysis required"
    },
    {
      "sqlstate": "22000",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "data_exception",
      "severity": "ERROR",
      "description": "Data exception (generic)",
      "root_cause": "General data-related error not covered by more specific SQLSTATEs",
      "remediation": "Examine detailed error message; validate data constraints; check application data validation logic",
      "common_scenarios": ["Custom check constraints violation", "Application-specific data validation failure"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Correlate with application logs"
    },
    {
      "sqlstate": "2202E",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "array_subscript_error",
      "severity": "ERROR",
      "description": "Array subscript error",
      "root_cause": "Array index out of bounds or invalid array subscript expression",
      "remediation": "Validate array bounds before access; use array_length() for dynamic sizing; handle NULL arrays explicitly",
      "common_scenarios": ["Accessing array[0] (PostgreSQL arrays are 1-based by default)", "Negative index without explicit bounds declaration", "NULL array dereferencing"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Application input validation"
    },
    {
      "sqlstate": "22021",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "character_not_in_repertoire",
      "severity": "ERROR",
      "description": "Character not in repertoire",
      "root_cause": "Character encoding mismatch; character cannot be represented in target encoding",
      "remediation": "Ensure consistent encoding across client/server/database; use UTF8 encoding universally; validate input encoding before insertion",
      "common_scenarios": ["Client sending LATIN1 to UTF8 database", "Copy-paste from applications with mixed encodings", "Legacy system data migration"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Encoding consistency audit"
    },
    {
      "sqlstate": "22008",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "datetime_field_overflow",
      "severity": "ERROR",
      "description": "Datetime field overflow",
      "root_cause": "Date/time value exceeds supported range (4713 BC to 294276 AD) or precision overflow",
      "remediation": "Validate date ranges in application; avoid extreme dates from external systems; use appropriate data types (TIMESTAMP vs TIMESTAMPTZ)",
      "common_scenarios": ["Excel date conversion errors (1900 vs 1904 epoch)", "Legacy system using year 0", "Unbounded date arithmetic"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Input validation at API gateway"
    },
    {
      "sqlstate": "22012",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "division_by_zero",
      "severity": "ERROR",
      "description": "Division by zero",
      "root_cause": "Arithmetic division operation with zero divisor",
      "remediation": "Add divisor validation before division; use NULLIF(divisor, 0) to return NULL instead of error; implement business rule for zero handling",
      "common_scenarios": ["Financial calculations with zero denominator", "Aggregation without handling empty sets", "Dynamic divisor from user input"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Business logic validation"
    },
    {
      "sqlstate": "22005",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "error_in_assignment",
      "severity": "ERROR",
      "description": "Error in assignment",
      "root_cause": "Value cannot be assigned to target due to type incompatibility or constraint violation",
      "remediation": "Validate type compatibility; use explicit casts where safe; check CHECK constraints on target column",
      "common_scenarios": ["INSERT with incompatible type", "Function parameter type mismatch", "Trigger NEW assignment violation"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Schema change impact analysis"
    },
    {
      "sqlstate": "2200B",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "escape_character_conflict",
      "severity": "ERROR",
      "description": "Escape character conflict",
      "root_cause": "ESCAPE clause in LIKE/ SIMILAR TO contains invalid or conflicting escape character",
      "remediation": "Use standard escape character (\); avoid characters that conflict with pattern syntax; consider USING clause for explicit escaping",
      "common_scenarios": ["ESCAPE '\\' in string literal requiring double escaping", "ESCAPE character appearing in pattern without escaping"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Query review"
    },
    {
      "sqlstate": "22022",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "indicator_overflow",
      "severity": "ERROR",
      "description": "Indicator overflow",
      "root_cause": "Indicator variable too small to hold result status (ODBC/JDBC specific)",
      "remediation": "Increase indicator variable size; update driver configuration; avoid deprecated indicator usage patterns",
      "common_scenarios": ["Legacy ODBC application", "Driver version mismatch"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Driver compatibility check"
    },
    {
      "sqlstate": "22015",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "interval_field_overflow",
      "severity": "ERROR",
      "description": "Interval field overflow",
      "root_cause": "Interval value exceeds maximum representable value or precision",
      "remediation": "Validate interval ranges; avoid unbounded date arithmetic; use appropriate interval units",
      "common_scenarios": ["AGE() on dates spanning millennia", "Interval multiplication causing overflow", "Legacy system interval conversion"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Query pattern review"
    },
    {
      "sqlstate": "2201E",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_argument_for_logarithm",
      "severity": "ERROR",
      "description": "Invalid argument for logarithm",
      "root_cause": "LOG(), LN(), or LOG10() called with non-positive argument",
      "remediation": "Validate argument > 0 before logarithm calculation; handle edge cases in business logic",
      "common_scenarios": ["Financial calculations with zero/negative values", "Statistical functions on sparse data"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Business logic validation"
    },
    {
      "sqlstate": "22014",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_argument_for_ntile_function",
      "severity": "ERROR",
      "description": "Invalid argument for NTILE function",
      "root_cause": "NTILE() called with non-positive bucket count",
      "remediation": "Validate bucket count > 0 before window function execution",
      "common_scenarios": ["Dynamic bucket count from user input", "Edge case in pagination logic"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Application input validation"
    },
    {
      "sqlstate": "22016",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_argument_for_nth_value_function",
      "severity": "ERROR",
      "description": "Invalid argument for NTH_VALUE function",
      "root_cause": "NTH_VALUE() called with non-positive N argument",
      "remediation": "Validate N > 0 before window function execution",
      "common_scenarios": ["Dynamic N from user input", "Off-by-one errors in ranking logic"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Application input validation"
    },
    {
      "sqlstate": "2201F",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_argument_for_power_function",
      "severity": "ERROR",
      "description": "Invalid argument for power function",
      "root_cause": "POWER() or ^ operator with invalid combination (e.g., negative base with fractional exponent)",
      "remediation": "Validate base/exponent combinations; handle domain errors explicitly in application logic",
      "common_scenarios": ["Financial compound interest calculations", "Statistical transformations on negative values"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Business logic validation"
    },
    {
      "sqlstate": "2201G",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_argument_for_width_bucket_function",
      "severity": "ERROR",
      "description": "Invalid argument for WIDTH_BUCKET function",
      "root_cause": "WIDTH_BUCKET() with invalid bucket count or boundary values",
      "remediation": "Validate bucket count > 0 and boundaries in correct order before execution",
      "common_scenarios": ["Dynamic histogram generation", "Edge cases in data distribution analysis"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Application input validation"
    },
    {
      "sqlstate": "22018",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_character_value_for_cast",
      "severity": "ERROR",
      "description": "Invalid character value for cast",
      "root_cause": "String cannot be cast to target type due to invalid format (e.g., 'abc'::INTEGER)",
      "remediation": "Validate input format before casting; use TRY_CAST pattern with exception handling; implement data quality checks at ingestion",
      "common_scenarios": ["CSV import with malformed numbers", "API accepting unvalidated user input", "ETL pipeline with dirty source data"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Data quality pipeline alert"
    },
    {
      "sqlstate": "22007",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_datetime_format",
      "severity": "ERROR",
      "description": "Invalid datetime format",
      "root_cause": "String cannot be parsed as date/time due to format mismatch or invalid values",
      "remediation": "Standardize datetime formats at ingestion; use explicit TO_TIMESTAMP() with format string; validate input before conversion",
      "common_scenarios": ["Mixed date formats in source data (MM/DD/YYYY vs DD/MM/YYYY)", "Locale-specific formats", "Timezone ambiguity"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Data quality pipeline alert"
    },
    {
      "sqlstate": "22019",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_escape_character",
      "severity": "ERROR",
      "description": "Invalid escape character",
      "root_cause": "ESCAPE clause specifies invalid or non-printable character",
      "remediation": "Use standard printable characters for escape sequences; avoid control characters",
      "common_scenarios": ["Binary data in escape clause", "Copy-paste errors from hex editors"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Query review"
    },
    {
      "sqlstate": "2200D",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_escape_octet",
      "severity": "ERROR",
      "description": "Invalid escape octet",
      "root_cause": "Escape sequence contains invalid byte sequence for current encoding",
      "remediation": "Ensure escape sequences are valid in database encoding; avoid manual byte manipulation",
      "common_scenarios": ["Binary protocol misuse", "Manual byte string construction"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Driver/library audit"
    },
    {
      "sqlstate": "22025",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_escape_sequence",
      "severity": "ERROR",
      "description": "Invalid escape sequence",
      "root_cause": "LIKE pattern contains malformed escape sequence",
      "remediation": "Double escape backslashes in string literals; use E'...' escape string syntax; validate patterns before execution",
      "common_scenarios": ["Windows path patterns ('C:\\\\')", "Regex-like patterns in LIKE clauses", "Copy-paste from regex engines"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Query pattern review"
    },
    {
      "sqlstate": "22P06",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "nonstandard_use_of_escape_character",
      "severity": "ERROR",
      "description": "Nonstandard use of escape character",
      "root_cause": "Escape character used in context where standard SQL doesn't permit it (backslash escapes in string literals with standard_conforming_strings=on)",
      "remediation": "Use standard SQL string literals; enable standard_conforming_strings; replace backslash escapes with explicit escape sequences",
      "common_scenarios": ["Legacy application migrated from MySQL", "Copy-paste from tutorials using backslash escapes"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Application migration audit"
    },
    {
      "sqlstate": "22010",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_indicator_parameter_value",
      "severity": "ERROR",
      "description": "Invalid indicator parameter value",
      "root_cause": "Indicator variable contains invalid value (ODBC/JDBC specific)",
      "remediation": "Update driver; avoid deprecated indicator usage; use modern parameter binding APIs",
      "common_scenarios": ["Legacy ODBC application", "Driver bug"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Driver compatibility check"
    },
    {
      "sqlstate": "22023",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_parameter_value",
      "severity": "ERROR",
      "description": "Invalid parameter value",
      "root_cause": "Function or operator received parameter outside valid domain",
      "remediation": "Validate parameters before function call; check documentation for valid ranges; implement input sanitization",
      "common_scenarios": ["SET statement with invalid GUC value", "Function called with out-of-range parameters", "Extension function misuse"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Application input validation"
    },
    {
      "sqlstate": "22013",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_preceding_or_following_size",
      "severity": "ERROR",
      "description": "Invalid PRECEDING or FOLLOWING size",
      "root_cause": "Window frame specification with negative or non-constant size",
      "remediation": "Use positive constants or expressions for frame bounds; avoid variables in frame specification",
      "common_scenarios": ["Dynamic window frames with negative values", "Copy-paste errors in window function definitions"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Query review"
    },
    {
      "sqlstate": "2201B",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_regular_expression",
      "severity": "ERROR",
      "description": "Invalid regular expression",
      "root_cause": "Malformed regex pattern in ~, ~*, SIMILAR TO, or regexp functions",
      "remediation": "Validate regex patterns before execution; use regex testing tools; avoid dynamic regex construction from untrusted input",
      "common_scenarios": ["User-provided search patterns", "Copy-paste from incompatible regex flavors (PCRE vs POSIX)", "Unescaped special characters"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Input validation at API layer"
    },
    {
      "sqlstate": "2201W",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_row_count_in_limit_clause",
      "severity": "ERROR",
      "description": "Invalid row count in LIMIT clause",
      "root_cause": "LIMIT clause with negative or non-integer value",
      "remediation": "Validate LIMIT parameter > 0; use GREATEST(parameter, 0) for dynamic limits; implement pagination safeguards",
      "common_scenarios": ["User-controlled pagination parameters", "Off-by-one errors in offset/limit calculation"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "API parameter validation"
    },
    {
      "sqlstate": "2201X",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_row_count_in_result_offset_clause",
      "severity": "ERROR",
      "description": "Invalid row count in OFFSET clause",
      "root_cause": "OFFSET clause with negative or non-integer value",
      "remediation": "Validate OFFSET parameter >= 0; implement cursor-based pagination for large offsets",
      "common_scenarios": ["User-controlled pagination parameters", "Integer overflow in offset calculation"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "API parameter validation"
    },
    {
      "sqlstate": "2202H",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_tablesample_argument",
      "severity": "ERROR",
      "description": "Invalid TABLESAMPLE argument",
      "root_cause": "TABLESAMPLE percentage outside valid range (0-100) or invalid repeatable seed",
      "remediation": "Validate TABLESAMPLE parameters before execution; avoid dynamic percentages from untrusted sources",
      "common_scenarios": ["Dynamic sampling for analytics", "Copy-paste errors in sampling queries"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Query review"
    },
    {
      "sqlstate": "2202G",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_tablesample_repeat",
      "severity": "ERROR",
      "description": "Invalid TABLESAMPLE repeat",
      "root_cause": "REPEATABLE clause with invalid seed value",
      "remediation": "Use valid integer seed for REPEATABLE clause; avoid floating point values",
      "common_scenarios": ["Copy-paste errors in sampling queries"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Query review"
    },
    {
      "sqlstate": "22009",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_time_zone_displacement_value",
      "severity": "ERROR",
      "description": "Invalid time zone displacement value",
      "root_cause": "Timezone offset outside valid range (-12:59 to +14:00) or malformed format",
      "remediation": "Use named timezones instead of offsets where possible; validate offset format before conversion",
      "common_scenarios": ["Legacy system using non-standard offsets", "Copy-paste errors in timezone strings"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Data validation"
    },
    {
      "sqlstate": "2200C",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_use_of_escape_character",
      "severity": "ERROR",
      "description": "Invalid use of escape character",
      "root_cause": "Escape character used where not permitted by SQL standard",
      "remediation": "Review SQL standard compliance; avoid non-standard escape sequences",
      "common_scenarios": ["Cross-database compatibility issues", "Legacy application patterns"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Query review"
    },
    {
      "sqlstate": "2200G",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_use_of_null",
      "severity": "ERROR",
      "description": "Invalid use of NULL",
      "root_cause": "NULL used in context where value is required (e.g., array subscript)",
      "remediation": "Validate for NULL before operations requiring non-NULL values; use COALESCE for defaults",
      "common_scenarios": ["Array access with NULL index", "Function requiring non-NULL parameter"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Application validation"
    },
    {
      "sqlstate": "22004",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "null_value_not_allowed",
      "severity": "ERROR",
      "description": "NULL value not allowed",
      "root_cause": "Operation requires non-NULL value but received NULL",
      "remediation": "Validate inputs for NULL before critical operations; use COALESCE/NVL for defaults; implement NOT NULL constraints where appropriate",
      "common_scenarios": ["Aggregate functions requiring non-NULL inputs", "Custom functions with strict NULL requirements"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Data quality monitoring"
    },
    {
      "sqlstate": "22002",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "null_value_no_indicator_parameter",
      "severity": "ERROR",
      "description": "NULL value without indicator parameter",
      "root_cause": "ODBC/JDBC binding NULL without proper indicator variable",
      "remediation": "Update driver; use modern parameter binding APIs that handle NULLs explicitly",
      "common_scenarios": ["Legacy ODBC application", "Driver bug"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Driver compatibility check"
    },
    {
      "sqlstate": "22003",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "numeric_value_out_of_range",
      "severity": "ERROR",
      "description": "Numeric value out of range",
      "root_cause": "Numeric value exceeds precision/scale limits of target type (e.g., 1000::SMALLINT)",
      "remediation": "Validate numeric ranges before casting; use appropriate data types (BIGINT vs INTEGER); implement overflow checks in application",
      "common_scenarios": ["Counter overflow in high-volume systems", "Currency conversion without scale validation", "Sensor data exceeding expected ranges"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Data quality alert with threshold monitoring"
    },
    {
      "sqlstate": "2200H",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "sequence_generator_limit_exceeded",
      "severity": "ERROR",
      "description": "Sequence generator limit exceeded",
      "root_cause": "Sequence reached MAXVALUE (or MINVALUE for descending) and CYCLE option not enabled",
      "remediation": "Enable CYCLE option on sequence; increase MAXVALUE; implement sequence rotation strategy; monitor sequence usage with pg_sequences",
      "common_scenarios": ["High-volume ID generation exhausting 32-bit sequences", "Legacy sequences not updated for scale", "Bulk loading without sequence awareness"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Proactive sequence exhaustion alert (80% threshold)"
    },
    {
      "sqlstate": "22026",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "string_data_length_mismatch",
      "severity": "ERROR",
      "description": "String data length mismatch",
      "root_cause": "String length doesn't match expected length for fixed-width operation",
      "remediation": "Use VARCHAR instead of CHAR for variable-length data; validate lengths before fixed-width operations",
      "common_scenarios": ["Legacy fixed-width file processing", "COBOL system integration"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Data integration pipeline validation"
    },
    {
      "sqlstate": "22001",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "string_data_right_truncation",
      "severity": "ERROR",
      "description": "String data right truncation",
      "root_cause": "String value longer than target column capacity with no implicit truncation allowed",
      "remediation": "Increase target column width; validate input length before insertion; implement client-side truncation with warning",
      "common_scenarios": ["User input exceeding VARCHAR limits", "ETL pipeline with unvalidated source lengths", "API payload with oversized fields"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Data quality alert with field-level metrics"
    },
    {
      "sqlstate": "22011",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "substring_error",
      "severity": "ERROR",
      "description": "Substring error",
      "root_cause": "SUBSTRING() with invalid start position or length (negative/non-integer)",
      "remediation": "Validate substring parameters before execution; handle edge cases explicitly",
      "common_scenarios": ["Dynamic substring with user input", "Off-by-one errors in string parsing"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Application validation"
    },
    {
      "sqlstate": "22027",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "trim_error",
      "severity": "ERROR",
      "description": "TRIM error",
      "root_cause": "TRIM() with invalid characters or malformed specification",
      "remediation": "Validate TRIM parameters; avoid control characters in trim set",
      "common_scenarios": ["Dynamic trim characters from untrusted input"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Application validation"
    },
    {
      "sqlstate": "22024",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "unterminated_c_string",
      "severity": "ERROR",
      "description": "Unterminated C string",
      "root_cause": "Byte sequence lacks null terminator required by C-string functions",
      "remediation": "Avoid direct C-string manipulation; use PostgreSQL text functions instead of byte-level operations",
      "common_scenarios": ["Foreign data wrapper issues", "Binary protocol misuse"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "FDW/driver audit"
    },
    {
      "sqlstate": "2200F",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "zero_length_character_string",
      "severity": "ERROR",
      "description": "Zero-length character string",
      "root_cause": "Operation requires non-empty string but received empty string",
      "remediation": "Validate string length before operations requiring non-empty values; implement business rules for empty values",
      "common_scenarios": ["Required field validation bypassed", "Trimmed strings becoming empty"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Application validation"
    },
    {
      "sqlstate": "22P01",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "floating_point_exception",
      "severity": "ERROR",
      "description": "Floating-point exception",
      "root_cause": "IEEE 754 floating-point error (NaN, infinity, underflow)",
      "remediation": "Validate floating-point inputs; avoid operations producing NaN/infinity; use NUMERIC for precise financial calculations",
      "common_scenarios": ["Division by zero in floating-point", "Exponentiation overflow", "Statistical calculations on extreme values"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Numerical stability audit"
    },
    {
      "sqlstate": "22P02",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_text_representation",
      "severity": "ERROR",
      "description": "Invalid text representation",
      "root_cause": "Application attempted to cast string to numeric/date type with invalid format (e.g., 'abc'::INTEGER)",
      "remediation": "Validate input data before casting; use TRY_CAST pattern with exception handling; implement data quality checks at ingestion; use STRICT mode in functions",
      "common_scenarios": ["CSV import with malformed numbers", "API accepting unvalidated user input", "ETL pipeline with dirty source data", "Locale mismatch in number formatting"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Critical data pipeline alert; correlate with source system metrics"
    },
    {
      "sqlstate": "22P03",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_binary_representation",
      "severity": "ERROR",
      "description": "Invalid binary representation",
      "root_cause": "Byte sequence cannot be decoded as target binary format (e.g., malformed JSONB, invalid geometry)",
      "remediation": "Validate binary formats before decoding; use format-specific validation functions (e.g., ST_IsValid for geometries); implement input sanitization",
      "common_scenarios": ["Corrupted binary data transmission", "Version mismatch in binary formats", "Malicious payload injection"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Security alert; data integrity validation"
    },
    {
      "sqlstate": "22P04",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "bad_copy_file_format",
      "severity": "ERROR",
      "description": "Bad COPY file format",
      "root_cause": "COPY command encountered malformed data file (incorrect delimiters, encoding issues, line breaks)",
      "remediation": "Validate source file format before COPY; use CSV format with explicit delimiters/quotes; implement pre-processing validation; use pg_bulkload for robust loading",
      "common_scenarios": ["CSV with embedded newlines not properly quoted", "Encoding mismatch between file and database", "Delimiter collision with data values"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "ETL pipeline alert with file-level diagnostics"
    },
    {
      "sqlstate": "22P05",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "untranslatable_character",
      "severity": "ERROR",
      "description": "Untranslatable character",
      "root_cause": "Character cannot be converted between client and server encodings",
      "remediation": "Standardize on UTF8 encoding across entire stack; use client_encoding GUC to match client capabilities; implement character replacement strategies for legacy systems",
      "common_scenarios": ["Windows-1252 client to UTF8 server with smart quotes", "Legacy mainframe EBCDIC data", "Emoji support mismatch"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Encoding consistency audit across environments"
    },
    {
      "sqlstate": "2200L",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "not_an_xml_document",
      "severity": "ERROR",
      "description": "Not an XML document",
      "root_cause": "String cannot be parsed as well-formed XML",
      "remediation": "Validate XML before parsing; use XML-specific validation tools; avoid dynamic XML construction from untrusted input",
      "common_scenarios": ["User-provided XML fragments", "Truncated XML documents", "Encoding issues in XML prolog"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Input validation at API layer"
    },
    {
      "sqlstate": "2200M",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_xml_document",
      "severity": "ERROR",
      "description": "Invalid XML document",
      "root_cause": "XML document violates schema/DTD constraints",
      "remediation": "Validate against schema before insertion; use xmllint for pre-validation; implement graceful degradation for non-critical XML",
      "common_scenarios": ["Schema evolution without backward compatibility", "Third-party XML feed changes"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Schema version tracking"
    },
    {
      "sqlstate": "2200N",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_xml_content",
      "severity": "ERROR",
      "description": "Invalid XML content",
      "root_cause": "XML content violates content model constraints",
      "remediation": "Validate content model before insertion; use XML schema validation",
      "common_scenarios": ["Element content violating mixed content rules", "Namespace misuse"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Schema validation"
    },
    {
      "sqlstate": "2200S",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_xml_comment",
      "severity": "ERROR",
      "description": "Invalid XML comment",
      "root_cause": "XML comment contains invalid characters or structure (-- inside comment)",
      "remediation": "Sanitize comments before XML construction; avoid dynamic comment generation from untrusted input",
      "common_scenarios": ["User-generated content in comments", "Copy-paste from HTML"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Input sanitization"
    },
    {
      "sqlstate": "2200T",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_xml_processing_instruction",
      "severity": "ERROR",
      "description": "Invalid XML processing instruction",
      "root_cause": "XML processing instruction malformed or contains invalid target",
      "remediation": "Validate processing instructions before XML construction",
      "common_scenarios": ["Malformed <?xml-stylesheet?> directives"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "XML generation audit"
    },
    {
      "sqlstate": "22030",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "duplicate_json_object_key_value",
      "severity": "ERROR",
      "description": "Duplicate JSON object key value",
      "root_cause": "JSON object contains duplicate keys (violates RFC 7159 which recommends uniqueness)",
      "remediation": "Deduplicate keys before JSON construction; use jsonb which automatically deduplicates (last value wins); validate JSON sources",
      "common_scenarios": ["Merging JSON objects without key conflict resolution", "Legacy systems generating non-compliant JSON"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "JSON schema validation"
    },
    {
      "sqlstate": "22031",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_argument_for_sql_json_datetime_function",
      "severity": "ERROR",
      "description": "Invalid argument for SQL/JSON datetime function",
      "root_cause": "JSON datetime function received invalid format or out-of-range value",
      "remediation": "Validate datetime formats before JSON processing; use explicit format specifications",
      "common_scenarios": ["Non-standard datetime formats in JSON", "Timezone ambiguity"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "JSON schema validation"
    },
    {
      "sqlstate": "22032",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_json_text",
      "severity": "ERROR",
      "description": "Invalid JSON text",
      "root_cause": "String cannot be parsed as valid JSON (syntax error, malformed structure)",
      "remediation": "Validate JSON syntax before parsing; use JSON linters in CI/CD; implement input sanitization; use jsonb_typeof() for validation",
      "common_scenarios": ["User-provided JSON payloads", "Truncated JSON responses from APIs", "Encoding issues in JSON strings", "Single quotes instead of double quotes"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "API gateway validation; security alert for malformed payloads"
    },
    {
      "sqlstate": "22033",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "invalid_sql_json_subscript",
      "severity": "ERROR",
      "description": "Invalid SQL/JSON subscript",
      "root_cause": "JSON subscript operation with invalid path or index",
      "remediation": "Validate JSON paths before execution; use jsonb_path_exists() for path validation",
      "common_scenarios": ["Dynamic path construction from user input", "Schema drift in JSON documents"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "JSON schema versioning"
    },
    {
      "sqlstate": "22034",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "more_than_one_sql_json_item",
      "severity": "ERROR",
      "description": "More than one SQL/JSON item",
      "root_cause": "JSON path expression returned multiple items where single item expected",
      "remediation": "Use path expressions that guarantee single result; handle multiple results explicitly with jsonb_path_query_array()",
      "common_scenarios": ["Ambiguous path expressions", "Schema changes causing multiplicity"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "JSON schema evolution tracking"
    },
    {
      "sqlstate": "22035",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "no_sql_json_item",
      "severity": "ERROR",
      "description": "No SQL/JSON item",
      "root_cause": "JSON path expression returned no items",
      "remediation": "Handle missing paths explicitly; use COALESCE with default values; validate document structure before querying",
      "common_scenarios": ["Optional fields missing in JSON documents", "Schema version mismatch", "Incomplete API responses"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "JSON schema versioning; document completeness metrics"
    },
    {
      "sqlstate": "22036",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "non_numeric_sql_json_item",
      "severity": "ERROR",
      "description": "Non-numeric SQL/JSON item",
      "root_cause": "JSON path expected numeric value but found non-numeric type",
      "remediation": "Validate JSON types before numeric operations; use jsonb_typeof() for type checking; implement type coercion with validation",
      "common_scenarios": ["Stringified numbers in JSON ('42' vs 42)", "Schema drift causing type changes"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "JSON schema validation"
    },
    {
      "sqlstate": "22037",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "non_unique_keys_in_a_json_object",
      "severity": "ERROR",
      "description": "Non-unique keys in a JSON object",
      "root_cause": "JSON object contains duplicate keys (jsonb enforces uniqueness)",
      "remediation": "Deduplicate keys before conversion to jsonb; use json type if duplicates required (not recommended)",
      "common_scenarios": ["Merging JSON objects without conflict resolution", "Legacy systems generating non-compliant JSON"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "JSON generation audit"
    },
    {
      "sqlstate": "22038",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "singleton_sql_json_item_required",
      "severity": "ERROR",
      "description": "Singleton SQL/JSON item required",
      "root_cause": "Operation requires single JSON item but path returned array or multiple items",
      "remediation": "Refine path expression to return single item; handle arrays explicitly",
      "common_scenarios": ["Ambiguous paths in nested structures", "Schema changes introducing arrays"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "JSON schema versioning"
    },
    {
      "sqlstate": "22039",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "sql_json_array_not_found",
      "severity": "ERROR",
      "description": "SQL/JSON array not found",
      "root_cause": "JSON path expected array but found scalar or object",
      "remediation": "Validate JSON structure before array operations; handle type variations explicitly",
      "common_scenarios": ["Schema drift (scalar -> array evolution)", "Incomplete data normalization"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "JSON schema evolution tracking"
    },
    {
      "sqlstate": "2203A",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "sql_json_member_not_found",
      "severity": "ERROR",
      "description": "SQL/JSON member not found",
      "root_cause": "JSON path references non-existent object member",
      "remediation": "Validate member existence before access; use jsonb_exists() or ? operator; implement graceful fallbacks",
      "common_scenarios": ["Optional fields missing", "Schema version mismatch", "Typos in path expressions"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "JSON schema versioning; field completeness metrics"
    },
    {
      "sqlstate": "2203B",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "sql_json_number_not_found",
      "severity": "ERROR",
      "description": "SQL/JSON number not found",
      "root_cause": "JSON path expected number but found different type or missing value",
      "remediation": "Validate type before numeric operations; use explicit type checking",
      "common_scenarios": ["Stringified numbers", "Missing optional numeric fields"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "JSON schema validation"
    },
    {
      "sqlstate": "2203C",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "sql_json_object_not_found",
      "severity": "ERROR",
      "description": "SQL/JSON object not found",
      "root_cause": "JSON path expected object but found scalar or array",
      "remediation": "Validate structure before object operations; handle type variations explicitly",
      "common_scenarios": ["Schema drift", "Incomplete normalization"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "JSON schema evolution tracking"
    },
    {
      "sqlstate": "2203D",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "too_many_json_array_elements",
      "severity": "ERROR",
      "description": "Too many JSON array elements",
      "root_cause": "Array exceeds implementation limits (extremely rare)",
      "remediation": "Chunk large arrays; avoid pathological JSON structures",
      "common_scenarios": ["Malicious payload", "Unbounded array generation"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Security alert"
    },
    {
      "sqlstate": "2203E",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "too_many_json_object_members",
      "severity": "ERROR",
      "description": "Too many JSON object members",
      "root_cause": "Object exceeds implementation limits (extremely rare)",
      "remediation": "Normalize large objects; avoid pathological JSON structures",
      "common_scenarios": ["Malicious payload", "Unbounded key generation"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Security alert"
    },
    {
      "sqlstate": "2203F",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "sql_json_scalar_required",
      "severity": "ERROR",
      "description": "SQL/JSON scalar required",
      "root_cause": "Operation requires scalar value but received array or object",
      "remediation": "Validate type before scalar operations; handle complex types explicitly",
      "common_scenarios": ["Schema drift", "Incomplete data extraction"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "JSON schema validation"
    },
    {
      "sqlstate": "2203G",
      "class": "22",
      "class_name": "Data Exception",
      "condition_name": "sql_json_item_cannot_be_cast_to_target_type",
      "severity": "ERROR",
      "description": "SQL/JSON item cannot be cast to target type",
      "root_cause": "JSON value incompatible with target SQL type",
      "remediation": "Validate type compatibility before casting; implement explicit conversion logic with error handling",
      "common_scenarios": ["Stringified booleans/numbers", "Complex types cast to primitives"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Data quality pipeline alert"
    },
    {
      "sqlstate": "23000",
      "class": "23",
      "class_name": "Integrity Constraint Violation",
      "condition_name": "integrity_constraint_violation",
      "severity": "ERROR",
      "description": "Integrity constraint violation (generic)",
      "root_cause": "Operation violates table constraints (PRIMARY KEY, FOREIGN KEY, UNIQUE, CHECK)",
      "remediation": "Identify specific constraint violated from error detail; validate data against constraint rules before operation",
      "common_scenarios": ["Bulk data loading without constraint validation", "Application bypassing business logic checks"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Constraint violation rate monitoring"
    },
    {
      "sqlstate": "23001",
      "class": "23",
      "class_name": "Integrity Constraint Violation",
      "condition_name": "restrict_violation",
      "severity": "ERROR",
      "description": "RESTRICT violation",
      "root_cause": "DELETE/UPDATE restricted by foreign key constraint with RESTRICT action",
      "remediation": "Delete child records first; use CASCADE action if business logic permits; implement soft delete pattern",
      "common_scenarios": ["Attempting to delete parent with existing children", "ORM cascade configuration mismatch"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Referential integrity audit"
    },
    {
      "sqlstate": "23502",
      "class": "23",
      "class_name": "Integrity Constraint Violation",
      "condition_name": "not_null_violation",
      "severity": "ERROR",
      "description": "NOT NULL constraint violation",
      "root_cause": "INSERT/UPDATE attempted to set NULL on column with NOT NULL constraint without DEFAULT value",
      "remediation": "Provide explicit value; add DEFAULT clause to column; validate input at application layer before database operation; implement API schema validation",
      "common_scenarios": ["ORM mapping missing field", "API payload missing required attribute", "Schema evolution without data migration", "Frontend form field omission"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Application validation layer audit; API schema enforcement"
    },
    {
      "sqlstate": "23503",
      "class": "23",
      "class_name": "Integrity Constraint Violation",
      "condition_name": "foreign_key_violation",
      "severity": "ERROR",
      "description": "Foreign key constraint violation",
      "root_cause": "INSERT/UPDATE references non-existent parent row; DELETE attempted on parent with existing children (without CASCADE)",
      "remediation": "Ensure parent row exists before child insertion; use DEFERRABLE constraints for complex transactions; implement soft delete pattern; validate referential integrity in application layer",
      "common_scenarios": ["Race condition in microservices", "Bulk delete without CASCADE", "Referential integrity broken by direct table modification", "Async processing with ordering issues"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Cross-service transaction monitoring; referential integrity checks"
    },
    {
      "sqlstate": "23505",
      "class": "23",
      "class_name": "Integrity Constraint Violation",
      "condition_name": "unique_violation",
      "severity": "ERROR",
      "description": "Unique constraint violation",
      "root_cause": "INSERT/UPDATE would create duplicate in column(s) with UNIQUE constraint or primary key",
      "remediation": "Use UPSERT (INSERT ... ON CONFLICT) pattern; implement application-level duplicate detection; verify sequence/surrogate key generation; check for race conditions in concurrent inserts",
      "common_scenarios": ["Race condition in concurrent inserts", "Sequence reset causing duplicates", "Natural key collision in business data", "Bulk import without duplicate detection"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Duplicate detection pipeline; sequence exhaustion monitoring"
    },
    {
      "sqlstate": "23514",
      "class": "23",
      "class_name": "Integrity Constraint Violation",
      "condition_name": "check_violation",
      "severity": "ERROR",
      "description": "CHECK constraint violation",
      "root_cause": "INSERT/UPDATE value violates CHECK constraint expression",
      "remediation": "Validate data against CHECK rules before insertion; document business rules enforced by CHECK constraints; implement application-level validation mirroring CHECK logic",
      "common_scenarios": ["Age < 0", "Status transition invalid per business rules", "Numeric range violations", "Regex pattern mismatches"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Business rule validation audit"
    },
    {
      "sqlstate": "23P01",
      "class": "23",
      "class_name": "Integrity Constraint Violation",
      "condition_name": "exclusion_violation",
      "severity": "ERROR",
      "description": "Exclusion constraint violation",
      "root_cause": "INSERT/UPDATE violates exclusion constraint (e.g., overlapping time ranges with GiST index)",
      "remediation": "Validate against existing rows before insertion; use advisory locks for complex exclusion checks; implement application-level conflict detection",
      "common_scenarios": ["Double-booking time slots", "Overlapping IP ranges", "Concurrent reservation systems"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Conflict detection monitoring; reservation system audit"
    },
    {
      "sqlstate": "24000",
      "class": "24",
      "class_name": "Invalid Cursor State",
      "condition_name": "invalid_cursor_state",
      "severity": "ERROR",
      "description": "Invalid cursor state",
      "root_cause": "Cursor operation attempted in invalid state (e.g., FETCH on closed cursor)",
      "remediation": "Validate cursor state before operations; implement proper cursor lifecycle management; avoid cursor reuse across transactions",
      "common_scenarios": ["Cursor closed by transaction end", "FETCH after cursor exhaustion", "Connection pool recycling cursors"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Application cursor management audit"
    },
    {
      "sqlstate": "25000",
      "class": "25",
      "class_name": "Invalid Transaction State",
      "condition_name": "invalid_transaction_state",
      "severity": "ERROR",
      "description": "Invalid transaction state",
      "root_cause": "Operation attempted in invalid transaction context",
      "remediation": "Review transaction management logic; avoid explicit transaction control in contexts managed by frameworks",
      "common_scenarios": ["BEGIN inside already-active transaction", "COMMIT in auto-commit mode", "Transaction control in connection pool"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Transaction management audit"
    },
    {
      "sqlstate": "25001",
      "class": "25",
      "class_name": "Invalid Transaction State",
      "condition_name": "active_sql_transaction",
      "severity": "ERROR",
      "description": "Active SQL transaction",
      "root_cause": "Attempt to start new transaction while one is already active",
      "remediation": "Use SAVEPOINT for nested transactions; avoid explicit BEGIN when framework manages transactions",
      "common_scenarios": ["ORM transaction nesting", "Connection pool transaction state leakage"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Framework transaction configuration audit"
    },
    {
      "sqlstate": "25002",
      "class": "25",
      "class_name": "Invalid Transaction State",
      "condition_name": "branch_transaction_already_active",
      "severity": "ERROR",
      "description": "Branch transaction already active",
      "root_cause": "Two-phase commit branch transaction already in progress",
      "remediation": "Complete or rollback existing branch transaction before starting new one",
      "common_scenarios": ["2PC coordinator bug", "Transaction timeout without cleanup"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "2PC transaction monitoring"
    },
    {
      "sqlstate": "25008",
      "class": "25",
      "class_name": "Invalid Transaction State",
      "condition_name": "held_cursor_requires_same_isolation_level",
      "severity": "ERROR",
      "description": "Held cursor requires same isolation level",
      "root_cause": "Cursor declared WITH HOLD used across transactions with different isolation levels",
      "remediation": "Use consistent isolation levels across transactions; avoid WITH HOLD cursors when isolation level may change",
      "common_scenarios": ["Connection pool with varying isolation levels", "Framework changing isolation dynamically"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Isolation level consistency audit"
    },
    {
      "sqlstate": "25003",
      "class": "25",
      "class_name": "Invalid Transaction State",
      "condition_name": "inappropriate_access_mode_for_branch_transaction",
      "severity": "ERROR",
      "description": "Inappropriate access mode for branch transaction",
      "root_cause": "Branch transaction access mode (READ ONLY/READ WRITE) mismatch",
      "remediation": "Ensure consistent access mode declaration for branch transactions",
      "common_scenarios": ["2PC configuration mismatch"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "2PC configuration audit"
    },
    {
      "sqlstate": "25004",
      "class": "25",
      "class_name": "Invalid Transaction State",
      "condition_name": "inappropriate_isolation_level_for_branch_transaction",
      "severity": "ERROR",
      "description": "Inappropriate isolation level for branch transaction",
      "root_cause": "Branch transaction isolation level mismatch in distributed transaction",
      "remediation": "Ensure consistent isolation level across all transaction branches",
      "common_scenarios": ["Heterogeneous distributed transactions"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Distributed transaction configuration audit"
    },
    {
      "sqlstate": "25005",
      "class": "25",
      "class_name": "Invalid Transaction State",
      "condition_name": "no_active_sql_transaction_for_branch_transaction",
      "severity": "ERROR",
      "description": "No active SQL transaction for branch transaction",
      "root_cause": "Branch transaction operation without active transaction context",
      "remediation": "Ensure transaction properly initiated before branch operations",
      "common_scenarios": ["2PC coordinator bug"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "2PC transaction monitoring"
    },
    {
      "sqlstate": "25006",
      "class": "25",
      "class_name": "Invalid Transaction State",
      "condition_name": "read_only_sql_transaction",
      "severity": "ERROR",
      "description": "Read-only SQL transaction",
      "root_cause": "Write operation attempted in READ ONLY transaction",
      "remediation": "Declare transaction as READ WRITE when writes are needed; validate transaction mode before writes",
      "common_scenarios": ["Analytics query accidentally including writes", "Framework misconfiguration"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Transaction mode audit"
    },
    {
      "sqlstate": "25007",
      "class": "25",
      "class_name": "Invalid Transaction State",
      "condition_name": "schema_and_data_statement_mixing_not_supported",
      "severity": "ERROR",
      "description": "Schema and data statement mixing not supported",
      "root_cause": "DDL and DML mixed in same transaction under certain conditions (rare)",
      "remediation": "Separate DDL and DML into different transactions; avoid DDL in application transactions",
      "common_scenarios": ["Schema migration tools", "Dynamic DDL generation"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Schema change process audit"
    },
    {
      "sqlstate": "25P01",
      "class": "25",
      "class_name": "Invalid Transaction State",
      "condition_name": "no_active_sql_transaction",
      "severity": "ERROR",
      "description": "No active SQL transaction",
      "root_cause": "Transaction control command (COMMIT/ROLLBACK) issued outside transaction block",
      "remediation": "Check transaction status before issuing control commands; avoid explicit COMMIT/ROLLBACK when framework manages transactions",
      "common_scenarios": ["Auto-commit mode with explicit COMMIT", "Connection pool transaction state leakage"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Transaction management audit"
    },
    {
      "sqlstate": "25P02",
      "class": "25",
      "class_name": "Invalid Transaction State",
      "condition_name": "in_failed_sql_transaction",
      "severity": "ERROR",
      "description": "In failed SQL transaction",
      "root_cause": "Commands issued after transaction entered failed state (due to previous error)",
      "remediation": "Rollback transaction after error; implement proper error handling that terminates transaction on first error",
      "common_scenarios": ["Application continuing after SQL error", "Missing exception handling in transaction blocks"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Application error handling audit"
    },
    {
      "sqlstate": "25P03",
      "class": "25",
      "class_name": "Invalid Transaction State",
      "condition_name": "idle_in_transaction_session_timeout",
      "severity": "ERROR",
      "description": "Idle in transaction session timeout",
      "root_cause": "Transaction remained idle longer than idle_in_transaction_session_timeout setting",
      "remediation": "Reduce transaction duration; implement proper transaction lifecycle (begin-use-commit/rollback); monitor long-running transactions; adjust timeout for legitimate long operations",
      "common_scenarios": ["Application bug leaving transactions open", "Debug session with open transaction", "Connection pool leak"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Immediate alert; correlate with pg_stat_activity; kill blocking sessions"
    },
    {
      "sqlstate": "25P04",
      "class": "25",
      "class_name": "Invalid Transaction State",
      "condition_name": "transaction_rollback",
      "severity": "ERROR",
      "description": "Transaction rollback",
      "root_cause": "Transaction explicitly rolled back (application-initiated)",
      "remediation": "Review application logic for intentional rollbacks; distinguish from error-induced rollbacks",
      "common_scenarios": ["Business rule validation failure", "Compensating transaction pattern"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Business logic audit"
    },
    {
      "sqlstate": "26000",
      "class": "26",
      "class_name": "Invalid SQL Statement Name",
      "condition_name": "invalid_sql_statement_name",
      "severity": "ERROR",
      "description": "Invalid SQL statement name",
      "root_cause": "EXECUTE attempted on non-existent prepared statement",
      "remediation": "Verify prepared statement exists; avoid statement name collisions; implement statement lifecycle management",
      "common_scenarios": ["Prepared statement expired due to cache eviction", "Connection pool statement leakage", "Typo in statement name"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Prepared statement cache monitoring"
    },
    {
      "sqlstate": "27000",
      "class": "27",
      "class_name": "Triggered Data Change Violation",
      "condition_name": "triggered_data_change Violation",
      "severity": "ERROR",
      "description": "Triggered data change violation",
      "root_cause": "Trigger or rule prevented data modification due to business rule violation",
      "remediation": "Review trigger logic; validate business rules before triggering operation; implement user-friendly error messages in triggers",
      "common_scenarios": ["Business rule enforcement via triggers", "Audit trigger blocking invalid state transitions"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Trigger logic audit"
    },
    {
      "sqlstate": "28000",
      "class": "28",
      "class_name": "Invalid Authorization Specification",
      "condition_name": "invalid_authorization_specification",
      "severity": "ERROR",
      "description": "Invalid authorization specification",
      "root_cause": "Authentication failure due to invalid credentials or method mismatch",
      "remediation": "Verify username/password; check pg_hba.conf authentication method; validate certificate/key for cert/peer auth; review password expiration policies",
      "common_scenarios": ["Typo in password", "pg_hba.conf method mismatch (md5 vs scram-sha-256)", "Expired password", "Certificate expiration"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Security alert; correlate with authentication logs; detect brute force attempts"
    },
    {
      "sqlstate": "28P01",
      "class": "28",
      "class_name": "Invalid Authorization Specification",
      "condition_name": "invalid_password",
      "severity": "ERROR",
      "description": "Invalid password",
      "root_cause": "Password authentication failed (incorrect password or account locked)",
      "remediation": "Reset password; verify account not locked; check password complexity requirements; review authentication logs for brute force attempts",
      "common_scenarios": ["Password typo", "Password rotation without application update", "Account lockout after failed attempts"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Security alert; account lockout monitoring; brute force detection"
    },
    {
      "sqlstate": "2B000",
      "class": "2B",
      "class_name": "Dependent Privilege Descriptors Still Exist",
      "condition_name": "dependent_privilege_descriptors_still_exist",
      "severity": "ERROR",
      "description": "Dependent privilege descriptors still exist",
      "root_cause": "Attempt to DROP object with dependent privileges (e.g., column with column-level privileges)",
      "remediation": "REVOKE dependent privileges first; use CASCADE option if appropriate; review privilege dependencies with \\dp",
      "common_scenarios": ["Schema cleanup without privilege revocation", "Automated schema migration tools"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Schema change process audit"
    },
    {
      "sqlstate": "2BP01",
      "class": "2B",
      "class_name": "Dependent Privilege Descriptors Still Exist",
      "condition_name": "dependent_objects_still_exist",
      "severity": "ERROR",
      "description": "Dependent objects still exist",
      "root_cause": "Attempt to DROP object with dependent objects (views, functions, etc.)",
      "remediation": "DROP dependent objects first; use CASCADE option if appropriate; review dependencies with pg_depend catalog",
      "common_scenarios": ["Schema cleanup without dependency analysis", "Automated schema migration tools"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Schema change impact analysis"
    },
    {
      "sqlstate": "2D000",
      "class": "2D",
      "class_name": "Invalid Transaction Termination",
      "condition_name": "invalid_transaction_termination",
      "severity": "ERROR",
      "description": "Invalid transaction termination",
      "root_cause": "Transaction terminated in invalid way (e.g., ROLLBACK in read-only transaction with specific conditions)",
      "remediation": "Review transaction termination logic; avoid explicit termination commands when framework manages transactions",
      "common_scenarios": ["Framework transaction management conflict"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Transaction management audit"
    },
    {
      "sqlstate": "2F000",
      "class": "2F",
      "class_name": "SQL Routine Exception",
      "condition_name": "sql_routine_exception",
      "severity": "ERROR",
      "description": "SQL routine exception (generic)",
      "root_cause": "Error within SQL function/procedure execution",
      "remediation": "Review function/procedure logic; check exception blocks; validate parameters",
      "common_scenarios": ["Function logic error", "Missing exception handling"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Function execution monitoring"
    },
    {
      "sqlstate": "2F005",
      "class": "2F",
      "class_name": "SQL Routine Exception",
      "condition_name": "function_executed_no_return_statement",
      "severity": "ERROR",
      "description": "Function executed without RETURN statement",
      "root_cause": "Function reached end without executing RETURN (for non-void functions)",
      "remediation": "Ensure all code paths execute RETURN; add final RETURN as safeguard; validate control flow logic",
      "common_scenarios": ["Missing RETURN in conditional branches", "Exception handler without RETURN"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Function code review"
    },
    {
      "sqlstate": "2F002",
      "class": "2F",
      "class_name": "SQL Routine Exception",
      "condition_name": "modifying_sql_data_not_permitted",
      "severity": "ERROR",
      "description": "Modifying SQL data not permitted",
      "root_cause": "Function declared as STABLE/IMMUTABLE attempted data modification",
      "remediation": "Declare function as VOLATILE if it modifies data; refactor to separate read/write operations",
      "common_scenarios": ["Function volatility misdeclaration", "Accidental DML in read function"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Function volatility audit"
    },
    {
      "sqlstate": "2F003",
      "class": "2F",
      "class_name": "SQL Routine Exception",
      "condition_name": "prohibited_sql_statement_attempted",
      "severity": "ERROR",
      "description": "Prohibited SQL statement attempted",
      "root_cause": "Function executed statement prohibited by its declaration (e.g., transaction control in non-atomic function)",
      "remediation": "Review function declaration constraints; refactor logic to comply with allowed operations",
      "common_scenarios": ["Transaction control in SQL functions", "DDL in restricted contexts"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Function declaration audit"
    },
    {
      "sqlstate": "2F004",
      "class": "2F",
      "class_name": "SQL Routine Exception",
      "condition_name": "reading_sql_data_not_permitted",
      "severity": "ERROR",
      "description": "Reading SQL data not permitted",
      "root_cause": "Function declared as NO SQL attempted data access",
      "remediation": "Declare function with appropriate data access level (CONTAINS SQL, READS SQL DATA)",
      "common_scenarios": ["Overly restrictive function declaration"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Function declaration audit"
    },
    {
      "sqlstate": "34000",
      "class": "34",
      "class_name": "Invalid Cursor Name",
      "condition_name": "invalid_cursor_name",
      "severity": "ERROR",
      "description": "Invalid cursor name",
      "root_cause": "Cursor name does not exist or is invalid",
      "remediation": "Verify cursor declared and still open; check for name collisions; validate cursor lifecycle",
      "common_scenarios": ["Typo in cursor name", "Cursor closed by transaction end", "Connection pool cursor leakage"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Cursor management audit"
    },
    {
      "sqlstate": "38000",
      "class": "38",
      "class_name": "External Routine Exception",
      "condition_name": "external_routine_exception",
      "severity": "ERROR",
      "description": "External routine exception (generic)",
      "root_cause": "Error in external function (C, PL/Python, PL/Perl, etc.)",
      "remediation": "Review external function code; check language handler logs; validate external dependencies",
      "common_scenarios": ["C function segfault", "Python exception in PL/Python", "Missing shared library"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "External function monitoring; sandbox isolation review"
    },
    {
      "sqlstate": "38001",
      "class": "38",
      "class_name": "External Routine Exception",
      "condition_name": "containing_sql_not_permitted",
      "severity": "ERROR",
      "description": "Containing SQL not permitted",
      "root_cause": "External function declared NO SQL attempted SQL execution",
      "remediation": "Declare function with appropriate SQL access level; refactor to separate SQL/non-SQL operations",
      "common_scenarios": ["Misdeclared function volatility/access"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Function declaration audit"
    },
    {
      "sqlstate": "38002",
      "class": "38",
      "class_name": "External Routine Exception",
      "condition_name": "modifying_sql_data_not_permitted",
      "severity": "ERROR",
      "description": "Modifying SQL data not permitted (external)",
      "root_cause": "External function declared STABLE/IMMUTABLE or READS SQL DATA attempted data modification",
      "remediation": "Declare function as VOLATILE with MODIFIES SQL DATA; refactor to comply with declaration",
      "common_scenarios": ["Misdeclared function volatility"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Function declaration audit"
    },
    {
      "sqlstate": "38003",
      "class": "38",
      "class_name": "External Routine Exception",
      "condition_name": "prohibited_sql_statement_attempted",
      "severity": "ERROR",
      "description": "Prohibited SQL statement attempted (external)",
      "root_cause": "External function executed statement prohibited by its declaration",
      "remediation": "Review function declaration constraints; refactor logic to comply with allowed operations",
      "common_scenarios": ["Transaction control in external functions"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Function declaration audit"
    },
    {
      "sqlstate": "38004",
      "class": "38",
      "class_name": "External Routine Exception",
      "condition_name": "reading_sql_data_not_permitted",
      "severity": "ERROR",
      "description": "Reading SQL data not permitted (external)",
      "root_cause": "External function declared NO SQL attempted data read",
      "remediation": "Declare function with appropriate SQL access level",
      "common_scenarios": ["Overly restrictive declaration"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Function declaration audit"
    },
    {
      "sqlstate": "39000",
      "class": "39",
      "class_name": "External Routine Invocation Exception",
      "condition_name": "external_routine_invocation_exception",
      "severity": "ERROR",
      "description": "External routine invocation exception (generic)",
      "root_cause": "Error during invocation of external routine",
      "remediation": "Verify external routine exists and is callable; check language handler configuration",
      "common_scenarios": ["Missing language handler", "Function signature mismatch"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Extension/function deployment audit"
    },
    {
      "sqlstate": "39001",
      "class": "39",
      "class_name": "External Routine Invocation Exception",
      "condition_name": "invalid_sqlstate_returned",
      "severity": "ERROR",
      "description": "Invalid SQLSTATE returned",
      "root_cause": "External function returned invalid SQLSTATE code",
      "remediation": "Validate SQLSTATE format in external function; use standard error codes",
      "common_scenarios": ["Custom error handling in C functions", "PL language bug"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "External function code review"
    },
    {
      "sqlstate": "39004",
      "class": "39",
      "class_name": "External Routine Invocation Exception",
      "condition_name": "null_value_not_allowed",
      "severity": "ERROR",
      "description": "NULL value not allowed (external routine)",
      "root_cause": "External function received NULL for parameter declared NOT NULL",
      "remediation": "Validate parameters before calling external function; handle NULLs explicitly",
      "common_scenarios": ["Missing NULL check before external call"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Parameter validation audit"
    },
    {
      "sqlstate": "39P01",
      "class": "39",
      "class_name": "External Routine Invocation Exception",
      "condition_name": "trigger_protocol_violated",
      "severity": "ERROR",
      "description": "Trigger protocol violated",
      "root_cause": "Trigger function violated trigger protocol (e.g., returned NULL for BEFORE row trigger)",
      "remediation": "Review trigger function return value logic; ensure compliance with trigger type requirements",
      "common_scenarios": ["BEFORE trigger returning NULL unintentionally", "Row vs statement trigger confusion"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Trigger function code review"
    },
    {
      "sqlstate": "39P02",
      "class": "39",
      "class_name": "External Routine Invocation Exception",
      "condition_name": "srf_protocol_violated",
      "severity": "ERROR",
      "description": "SRF protocol violated",
      "root_cause": "Set-returning function violated SRF protocol (e.g., incorrect call context)",
      "remediation": "Review SRF implementation; ensure proper use of SRF_IS_FIRSTCALL, SRF_RETURN_NEXT, etc.",
      "common_scenarios": ["C SRF implementation bug", "PL/pgSQL SRF misuse"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "SRF implementation audit"
    },
    {
      "sqlstate": "39P03",
      "class": "39",
      "class_name": "External Routine Invocation Exception",
      "condition_name": "event_trigger_protocol_violated",
      "severity": "ERROR",
      "description": "Event trigger protocol violated",
      "root_cause": "Event trigger function violated event trigger protocol",
      "remediation": "Review event trigger function implementation; ensure compliance with event trigger requirements",
      "common_scenarios": ["Event trigger returning invalid value", "Unsupported operation in event context"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Event trigger code review"
    },
    {
      "sqlstate": "3B000",
      "class": "3B",
      "class_name": "Savepoint Exception",
      "condition_name": "savepoint_exception",
      "severity": "ERROR",
      "description": "Savepoint exception (generic)",
      "root_cause": "Error related to savepoint operations",
      "remediation": "Review savepoint lifecycle; avoid duplicate savepoint names; ensure proper nesting",
      "common_scenarios": ["Duplicate savepoint name", "RELEASE non-existent savepoint"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Transaction management audit"
    },
    {
      "sqlstate": "3B001",
      "class": "3B",
      "class_name": "Savepoint Exception",
      "condition_name": "invalid_savepoint_specification",
      "severity": "ERROR",
      "description": "Invalid savepoint specification",
      "root_cause": "Malformed or invalid savepoint name/reference",
      "remediation": "Use valid identifier for savepoint names; avoid special characters; validate savepoint existence before RELEASE/ROLLBACK TO",
      "common_scenarios": ["Invalid identifier syntax", "Typo in savepoint name"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Savepoint usage audit"
    },
    {
      "sqlstate": "3D000",
      "class": "3D",
      "class_name": "Invalid Catalog Name",
      "condition_name": "invalid_catalog_name",
      "severity": "ERROR",
      "description": "Invalid catalog name",
      "root_cause": "Database name does not exist or is invalid",
      "remediation": "Verify database exists with \\l; check for case sensitivity with quoted identifiers; validate connection string",
      "common_scenarios": ["Typo in database name", "Database dropped", "Case-sensitive name mismatch ('MyDB' vs mydb)"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Immediate alert; database provisioning audit"
    },
    {
      "sqlstate": "3F000",
      "class": "3F",
      "class_name": "Invalid Schema Name",
      "condition_name": "invalid_schema_name",
      "severity": "ERROR",
      "description": "Invalid schema name",
      "root_cause": "Schema name does not exist or is invalid in current search path",
      "remediation": "Verify schema exists with \\dn; check search_path GUC; qualify objects with schema name; create missing schema",
      "common_scenarios": ["Missing schema migration", "search_path misconfiguration", "Case-sensitive schema name mismatch"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Schema deployment audit; search_path consistency check"
    },
    {
      "sqlstate": "40000",
      "class": "40",
      "class_name": "Transaction Rollback",
      "condition_name": "transaction_rollback",
      "severity": "ERROR",
      "description": "Transaction rollback (generic)",
      "root_cause": "Transaction rolled back due to error or explicit ROLLBACK",
      "remediation": "Review transaction error logs; implement proper error handling; distinguish intentional vs error-induced rollbacks",
      "common_scenarios": ["Application-initiated rollback", "Error-induced rollback"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Transaction failure rate monitoring"
    },
    {
      "sqlstate": "40001",
      "class": "40",
      "class_name": "Transaction Rollback",
      "condition_name": "serialization_failure",
      "severity": "ERROR",
      "description": "Serialization failure",
      "root_cause": "Serializable isolation level transaction rolled back due to serialization anomaly (write skew, phantom reads)",
      "remediation": "Implement retry logic with exponential backoff (3-5 retries typical); consider lowering isolation level if business logic permits; reduce transaction duration; avoid hot spots",
      "common_scenarios": ["High-concurrency financial transactions", "Inventory management systems", "Banking applications with strict consistency requirements", "Contention on popular rows"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Serialization failure rate alert; correlate with transaction duration metrics"
    },
    {
      "sqlstate": "40002",
      "class": "40",
      "class_name": "Transaction Rollback",
      "condition_name": "transaction_integrity_constraint_violation",
      "severity": "ERROR",
      "description": "Transaction integrity constraint violation",
      "root_cause": "Transaction violated deferrable constraint at commit time",
      "remediation": "Validate constraint satisfaction before commit; review deferrable constraint logic; implement pre-commit validation",
      "common_scenarios": ["Deferred foreign key validation failure", "Complex multi-table constraints"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Constraint validation audit"
    },
    {
      "sqlstate": "40003",
      "class": "40",
      "class_name": "Transaction Rollback",
      "condition_name": "statement_completion_unknown",
      "severity": "ERROR",
      "description": "Statement completion unknown",
      "root_cause": "Connection lost during statement execution; outcome unknown",
      "remediation": "Implement idempotent operations; use transaction IDs for reconciliation; design for at-least-once semantics; avoid non-idempotent operations over unstable networks",
      "common_scenarios": ["Network partition during execution", "Server crash mid-statement", "Client timeout during long operation"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Critical business operation alert; reconciliation process required"
    },
    {
      "sqlstate": "40P01",
      "class": "40",
      "class_name": "Transaction Rollback",
      "condition_name": "deadlock_detected",
      "severity": "ERROR",
      "description": "Deadlock detected",
      "root_cause": "Circular wait condition where Transaction A holds lock needed by B, and B holds lock needed by A",
      "remediation": "Implement consistent access ordering across application; reduce transaction duration; add deadlock retry logic (1-3 retries); monitor with pg_locks; avoid user interaction within transactions",
      "common_scenarios": ["Concurrent updates to same rows in different order", "Long-running transactions holding locks", "Batch jobs with overlapping data sets", "Application-level lock inversion"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Deadlock rate alert; correlate with lock wait times; identify hot spots"
    },
    {
      "sqlstate": "42000",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "syntax_error_or_access_rule_violation",
      "severity": "ERROR",
      "description": "Syntax error or access rule violation (generic)",
      "root_cause": "SQL syntax error or permission violation",
      "remediation": "Review detailed error message; validate SQL syntax; check object privileges",
      "common_scenarios": ["Malformed SQL", "Missing privileges"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Query pattern analysis; privilege audit"
    },
    {
      "sqlstate": "42601",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "syntax_error",
      "severity": "ERROR",
      "description": "SQL syntax error",
      "root_cause": "Malformed SQL statement with invalid tokens, missing keywords, or incorrect structure",
      "remediation": "Validate SQL syntax before execution; use parameterized queries; implement SQL linting in CI/CD pipeline; avoid dynamic SQL generation without validation",
      "common_scenarios": ["SQL injection attempts", "Dynamic SQL generation bugs", "Copy-paste errors in migration scripts", "ORM query builder bugs"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Security alert for injection patterns; query validation at gateway"
    },
    {
      "sqlstate": "42501",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "insufficient_privilege",
      "severity": "ERROR",
      "description": "Insufficient privilege",
      "root_cause": "Role lacks required privilege for operation (SELECT, INSERT, EXECUTE, etc.)",
      "remediation": "GRANT required privilege; review role membership; implement least-privilege principle; use SECURITY DEFINER functions for controlled privilege escalation",
      "common_scenarios": ["New application role without proper grants", "Schema change without privilege update", "Row-level security policies blocking access"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Security audit; privilege change tracking; RLS policy review"
    },
    {
      "sqlstate": "42846",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "cannot_coerce",
      "severity": "ERROR",
      "description": "Cannot coerce",
      "root_cause": "Type coercion between source and target types not possible",
      "remediation": "Use explicit cast with intermediate type; implement custom cast function; refactor to avoid problematic coercion",
      "common_scenarios": ["Complex type hierarchy mismatch", "Custom type without cast definition"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Type system audit"
    },
    {
      "sqlstate": "42803",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "grouping_error",
      "severity": "ERROR",
      "description": "Grouping error",
      "root_cause": "Column in SELECT/HAVING not in GROUP BY and not in aggregate function",
      "remediation": "Add column to GROUP BY; wrap in aggregate function; enable GROUPING SETS/CUBE/ROLLUP if appropriate; set sql_mode to allow functional dependencies (PostgreSQL doesn't support this)",
      "common_scenarios": ["MySQL-compatible queries migrated to PostgreSQL", "Ambiguous grouping semantics", "Complex analytical queries"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Query pattern analysis"
    },
    {
      "sqlstate": "42P20",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "windowing_error",
      "severity": "ERROR",
      "description": "Windowing error",
      "root_cause": "Invalid window function usage (e.g., nested window functions, invalid framing)",
      "remediation": "Review window function syntax; avoid nesting window functions; validate frame specifications",
      "common_scenarios": ["Nested window functions", "Invalid frame bounds", "ORDER BY missing in window definition"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Query review"
    },
    {
      "sqlstate": "42P19",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "invalid_recursion",
      "severity": "ERROR",
      "description": "Invalid recursion",
      "root_cause": "Recursive CTE lacks proper termination condition or has invalid structure",
      "remediation": "Ensure recursive CTE has base case and termination condition; validate recursion depth; set max_cte_recursion_depth if needed",
      "common_scenarios": ["Infinite recursion in hierarchical queries", "Missing UNION/UNION ALL in recursive CTE", "Cycle detection not implemented"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Query execution timeout alert; recursion depth monitoring"
    },
    {
      "sqlstate": "42830",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "invalid_foreign_key",
      "severity": "ERROR",
      "description": "Invalid foreign key",
      "root_cause": "FOREIGN KEY definition references non-existent column or incompatible types",
      "remediation": "Verify referenced table/column exists; ensure type compatibility; check for case sensitivity with quoted identifiers",
      "common_scenarios": ["Typo in referenced column", "Type mismatch between FK and PK", "Referenced table not yet created in migration"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Schema migration validation"
    },
    {
      "sqlstate": "42602",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "invalid_name",
      "severity": "ERROR",
      "description": "Invalid name",
      "root_cause": "Identifier violates naming rules (reserved keyword, invalid characters, length)",
      "remediation": "Quote identifiers containing special characters/reserved words; avoid reserved keywords; follow naming conventions",
      "common_scenarios": ["Using 'user' as table name without quotes", "Identifier exceeding 63-byte limit", "Special characters in unquoted identifiers"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Schema design review"
    },
    {
      "sqlstate": "42622",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "name_too_long",
      "severity": "ERROR",
      "description": "Name too long",
      "root_cause": "Identifier exceeds 63 bytes (NAMEDATALEN limit)",
      "remediation": "Shorten identifier name; use abbreviations; avoid excessively long generated names",
      "common_scenarios": ["ORM-generated constraint names", "Auto-generated index names from long column names", "Migration tool name generation"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Schema migration validation"
    },
    {
      "sqlstate": "42939",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "reserved_name",
      "severity": "ERROR",
      "description": "Reserved name",
      "root_cause": "Attempt to use reserved system name (e.g., pg_ prefix)",
      "remediation": "Avoid pg_ prefix for user objects; use application-specific prefix; rename conflicting objects",
      "common_scenarios": ["Creating table named 'pg_temp'", "Extension using reserved namespace"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Naming convention enforcement"
    },
    {
      "sqlstate": "42804",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "datatype_mismatch",
      "severity": "ERROR",
      "description": "Datatype mismatch",
      "root_cause": "Operation requires compatible types but received incompatible types",
      "remediation": "Use explicit casts where safe; validate type compatibility; refactor schema to align types",
      "common_scenarios": ["JOIN on incompatible types (INTEGER vs TEXT)", "Function parameter type mismatch", "UNION of incompatible types"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Schema evolution impact analysis"
    },
    {
      "sqlstate": "42P18",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "indeterminate_datatype",
      "severity": "ERROR",
      "description": "Indeterminate datatype",
      "root_cause": "Expression type cannot be determined from context (e.g., NULL literal without cast)",
      "remediation": "Add explicit type cast to ambiguous expressions; avoid untyped literals in critical contexts",
      "common_scenarios": ["CASE expression with all NULL branches", "ARRAY[NULL] without type annotation", "Function with polymorphic arguments and untyped literals"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Query review"
    },
    {
      "sqlstate": "42P21",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "collation_mismatch",
      "severity": "ERROR",
      "description": "Collation mismatch",
      "root_cause": "Operation requires compatible collations but received incompatible collations",
      "remediation": "Ensure consistent collation usage; explicitly specify collation where needed; avoid mixing collations in expressions",
      "common_scenarios": ["JOIN on columns with different collations", "Expression mixing database default and column collations"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Collation consistency audit"
    },
    {
      "sqlstate": "42P22",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "indeterminate_collation",
      "severity": "ERROR",
      "description": "Indeterminate collation",
      "root_cause": "Collation cannot be determined from context",
      "remediation": "Explicitly specify collation for ambiguous expressions; ensure consistent collation usage",
      "common_scenarios": ["Expression with multiple possible collations", "Polymorphic functions with collatable arguments"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Collation design review"
    },
    {
      "sqlstate": "42809",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "wrong_object_type",
      "severity": "ERROR",
      "description": "Wrong object type",
      "root_cause": "Object used in context requiring different type (e.g., table used where function expected)",
      "remediation": "Verify object type matches usage context; check for name collisions between object types",
      "common_scenarios": ["Function and table with same name", "View used where materialized view expected", "Index used in FROM clause"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Schema object naming audit"
    },
    {
      "sqlstate": "428C9",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "generated_column_cannot_be_written",
      "severity": "ERROR",
      "description": "Generated column cannot be written",
      "root_cause": "Attempt to INSERT/UPDATE value in GENERATED ALWAYS column",
      "remediation": "Exclude generated columns from INSERT/UPDATE; use GENERATED BY DEFAULT if manual override needed; refactor to computed column pattern",
      "common_scenarios": ["ORM attempting to set computed column", "Bulk load including generated columns", "Schema evolution adding GENERATED without application update"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Application schema synchronization audit"
    },
    {
      "sqlstate": "42703",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "undefined_column",
      "severity": "ERROR",
      "description": "Undefined column",
      "root_cause": "Column referenced in query does not exist in target table/view",
      "remediation": "Verify column exists with \\d table_name; check for case sensitivity with quoted identifiers ('MyCol' vs mycol); implement schema versioning and migration tracking; use IDE with schema awareness",
      "common_scenarios": ["Schema drift between environments", "Case-sensitive column names", "ORM model out of sync with database", "Column dropped without application update"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Schema change impact analysis; application deployment synchronization"
    },
    {
      "sqlstate": "42883",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "undefined_function",
      "severity": "ERROR",
      "description": "Undefined function",
      "root_cause": "Function or operator does not exist with given name and argument types",
      "remediation": "Verify function exists in pg_proc; check extension is installed (CREATE EXTENSION); cast arguments to expected types; review search_path for schema qualification",
      "common_scenarios": ["Missing pg_trgm extension for trigram operations", "Version mismatch after upgrade", "Custom function not deployed to all environments", "Operator precedence causing unexpected resolution"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Extension deployment audit; schema synchronization"
    },
    {
      "sqlstate": "42P01",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "undefined_table",
      "severity": "ERROR",
      "description": "Undefined table",
      "root_cause": "Referenced table, view, or sequence does not exist",
      "remediation": "Verify table exists with \\dt; check search_path; qualify with schema name; implement schema migration validation; check for case sensitivity with quoted identifiers",
      "common_scenarios": ["Missing schema migration in new environment", "Race condition in parallel deployments", "Case-sensitive table names", "Temporary table scope issues"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Immediate alert; schema deployment pipeline validation"
    },
    {
      "sqlstate": "42P02",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "undefined_parameter",
      "severity": "ERROR",
      "description": "Undefined parameter",
      "root_cause": "Parameter reference in prepared statement or function does not exist",
      "remediation": "Verify parameter count and numbering; check for off-by-one errors; validate parameter binding in client code",
      "common_scenarios": ["JDBC/ODBC parameter indexing error", "Dynamic SQL parameter mismatch", "Copy-paste error in parameterized query"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Application parameter binding audit"
    },
    {
      "sqlstate": "42704",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "undefined_object",
      "severity": "ERROR",
      "description": "Undefined object",
      "root_cause": "Referenced object (type, domain, collation, etc.) does not exist",
      "remediation": "Verify object exists in catalog; check schema qualification; validate extension dependencies",
      "common_scenarios": ["Missing enum type", "Custom domain not created", "Collation not available on OS"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Schema deployment validation"
    },
    {
      "sqlstate": "42701",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "duplicate_column",
      "severity": "ERROR",
      "description": "Duplicate column",
      "root_cause": "CREATE TABLE or ALTER TABLE specifies same column name multiple times",
      "remediation": "Remove duplicate column definition; validate DDL generation logic; check for case-insensitive duplicates with quoted identifiers",
      "common_scenarios": ["ORM model with duplicate field names", "Migration script copy-paste error", "Case-sensitive name collision ('Col' vs 'col')"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "DDL generation audit"
    },
    {
      "sqlstate": "42P03",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "duplicate_cursor",
      "severity": "ERROR",
      "description": "Duplicate cursor",
      "root_cause": "DECLARE CURSOR with name already in use in current session",
      "remediation": "Use unique cursor names; close existing cursor before redeclaration; implement cursor naming convention with session ID",
      "common_scenarios": ["Connection pool cursor leakage", "Recursive function declaring same cursor name"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Cursor management audit"
    },
    {
      "sqlstate": "42P04",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "duplicate_database",
      "severity": "ERROR",
      "description": "Duplicate database",
      "root_cause": "CREATE DATABASE with name already existing",
      "remediation": "Check database existence before creation; implement idempotent database creation scripts; use IF NOT EXISTS clause",
      "common_scenarios": ["Idempotent provisioning scripts", "Parallel database creation attempts"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Provisioning script audit"
    },
    {
      "sqlstate": "42723",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "duplicate_function",
      "severity": "ERROR",
      "description": "Duplicate function",
      "root_cause": "CREATE FUNCTION with same name, argument types, and volatility as existing function",
      "remediation": "Use CREATE OR REPLACE FUNCTION; drop existing function first; verify function signature uniqueness",
      "common_scenarios": ["Deployment without DROP before CREATE", "Extension upgrade conflict", "Schema evolution without versioning"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Function deployment pipeline audit"
    },
    {
      "sqlstate": "42P05",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "duplicate_prepared_statement",
      "severity": "ERROR",
      "description": "Duplicate prepared statement",
      "root_cause": "PREPARE with name already in use in current session",
      "remediation": "DEALLOCATE existing statement first; use unique names; implement statement lifecycle management",
      "common_scenarios": ["Connection pool statement leakage", "Application retry logic without DEALLOCATE"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Prepared statement cache monitoring"
    },
    {
      "sqlstate": "42P06",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "duplicate_schema",
      "severity": "ERROR",
      "description": "Duplicate schema",
      "root_cause": "CREATE SCHEMA with name already existing",
      "remediation": "Check schema existence before creation; use IF NOT EXISTS clause; implement idempotent schema creation",
      "common_scenarios": ["Idempotent migration scripts", "Parallel schema creation"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Schema migration audit"
    },
    {
      "sqlstate": "42P07",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "duplicate_table",
      "severity": "ERROR",
      "description": "Duplicate table",
      "root_cause": "CREATE TABLE with name already existing",
      "remediation": "Use IF NOT EXISTS clause; DROP before CREATE if intentional replacement; verify table doesn't exist in any schema in search_path",
      "common_scenarios": ["Migration script without idempotency", "Parallel deployment conflict", "Temporary table name collision"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Migration pipeline validation"
    },
    {
      "sqlstate": "42712",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "duplicate_alias",
      "severity": "ERROR",
      "description": "Duplicate alias",
      "root_cause": "Query uses same alias for multiple relations or columns",
      "remediation": "Use unique aliases; avoid ambiguous column references; qualify columns with table aliases",
      "common_scenarios": ["Self-join without distinct aliases", "Subquery with same alias as outer query", "SELECT * with duplicate column names from JOIN"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Query review"
    },
    {
      "sqlstate": "42710",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "duplicate_object",
      "severity": "ERROR",
      "description": "Duplicate object",
      "root_cause": "CREATE statement for object that already exists (constraint, index, trigger, etc.)",
      "remediation": "Check object existence before creation; use IF NOT EXISTS where supported; implement idempotent DDL",
      "common_scenarios": ["Migration script re-run", "Parallel deployment", "Extension reinstallation"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "DDL idempotency audit"
    },
    {
      "sqlstate": "42702",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "ambiguous_column",
      "severity": "ERROR",
      "description": "Ambiguous column",
      "root_cause": "Column reference matches multiple tables in query scope",
      "remediation": "Qualify column with table alias/name; avoid SELECT * in multi-table queries; use unique column names across joined tables",
      "common_scenarios": ["JOIN on tables with same column names", "SELECT * causing ambiguity", "Subquery with column shadowing"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Query pattern analysis"
    },
    {
      "sqlstate": "42725",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "ambiguous_function",
      "severity": "ERROR",
      "description": "Ambiguous function",
      "root_cause": "Function call matches multiple candidates with same argument types after coercion",
      "remediation": "Add explicit type casts to arguments; qualify function with schema name; drop unused function overloads",
      "common_scenarios": ["Multiple extensions providing same function name", "Custom function shadowing built-in", "Polymorphic function ambiguity"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Function namespace audit"
    },
    {
      "sqlstate": "42P08",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "ambiguous_parameter",
      "severity": "ERROR",
      "description": "Ambiguous parameter",
      "root_cause": "Parameter reference ambiguous in context (rare)",
      "remediation": "Review parameter usage context; avoid complex parameter interactions",
      "common_scenarios": ["Edge case in PL/pgSQL parameter resolution"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Function code review"
    },
    {
      "sqlstate": "42P09",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "ambiguous_alias",
      "severity": "ERROR",
      "description": "Ambiguous alias",
      "root_cause": "Alias reference matches multiple scopes",
      "remediation": "Use distinct aliases; avoid alias reuse across query scopes",
      "common_scenarios": ["Nested subqueries with same alias", "CTE and table with same alias"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Query review"
    },
    {
      "sqlstate": "42P10",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "invalid_column_reference",
      "severity": "ERROR",
      "description": "Invalid column reference",
      "root_cause": "Column reference invalid in current context (e.g., GROUP BY column in WHERE clause)",
      "remediation": "Move condition to HAVING clause; restructure query to valid scope; understand SQL evaluation order",
      "common_scenarios": ["Aggregate in WHERE clause", "Window function in WHERE clause", "GROUP BY column alias in WHERE"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Query pattern analysis"
    },
    {
      "sqlstate": "42611",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "invalid_column_definition",
      "severity": "ERROR",
      "description": "Invalid column definition",
      "root_cause": "Column definition violates type constraints or syntax rules",
      "remediation": "Review column definition syntax; validate type constraints; check for conflicting options (e.g., GENERATED with DEFAULT)",
      "common_scenarios": ["Conflicting column options", "Invalid type modifier", "CHECK constraint referencing other columns in CREATE TABLE"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "DDL validation"
    },
    {
      "sqlstate": "42P11",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "invalid_cursor_definition",
      "severity": "ERROR",
      "description": "Invalid cursor definition",
      "root_cause": "Cursor declaration violates syntax or semantic rules",
      "remediation": "Review cursor declaration syntax; validate query within cursor",
      "common_scenarios": ["Cursor with data-modifying query", "Invalid cursor options"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Cursor usage audit"
    },
    {
      "sqlstate": "42P12",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "invalid_database_definition",
      "severity": "ERROR",
      "description": "Invalid database definition",
      "root_cause": "CREATE DATABASE options violate constraints or system limits",
      "remediation": "Review database creation options; validate against system limits; check template database validity",
      "common_scenarios": ["Invalid encoding/locale combination", "Template database in use", "Disk quota exceeded"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Provisioning system audit"
    },
    {
      "sqlstate": "42P13",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "invalid_function_definition",
      "severity": "ERROR",
      "description": "Invalid function definition",
      "root_cause": "Function definition violates syntax, type, or semantic rules",
      "remediation": "Review function signature and body; validate return type matches implementation; check language handler compatibility",
      "common_scenarios": ["RETURN type mismatch", "VOLATILE function in index expression", "STRICT function with NULL handling"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Function deployment audit"
    },
    {
      "sqlstate": "42P14",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "invalid_schema_definition",
      "severity": "ERROR",
      "description": "Invalid schema definition",
      "root_cause": "CREATE SCHEMA violates naming rules or authorization constraints",
      "remediation": "Verify schema name validity; check authorization for AUTHORIZATION clause",
      "common_scenarios": ["Reserved schema name", "Insufficient privileges for AUTHORIZATION"],
      "rca_priority": "LOW",
      "monitoring_recommendation": "Schema provisioning audit"
    },
    {
      "sqlstate": "42P15",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "invalid_table_definition",
      "severity": "ERROR",
      "description": "Invalid table definition",
      "root_cause": "CREATE TABLE violates constraints (e.g., multiple primary keys, invalid inheritance)",
      "remediation": "Review table definition; validate constraints; check inheritance hierarchy compatibility",
      "common_scenarios": ["Multiple PRIMARY KEY constraints", "Incompatible column types in inheritance", "Partition key mismatch"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Schema design review"
    },
    {
      "sqlstate": "42P16",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "invalid_object_definition",
      "severity": "ERROR",
      "description": "Invalid object definition",
      "root_cause": "Object definition (index, constraint, etc.) violates semantic rules",
      "remediation": "Review object definition; validate against PostgreSQL constraints; check for circular dependencies",
      "common_scenarios": ["Exclusion constraint without GiST index", "FOREIGN KEY referencing non-unique column", "Index on system column"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Schema design review"
    },
    {
      "sqlstate": "42P17",
      "class": "42",
      "class_name": "Syntax Error or Access Rule Violation",
      "condition_name": "invalid_object_definition",
      "severity": "ERROR",
      "description": "Invalid object definition (specific case)",
      "root_cause": "Object definition violates specific semantic constraint",
      "remediation": "Review specific constraint violation in error detail; adjust definition accordingly",
      "common_scenarios": ["Edge case in constraint definition"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Schema design review"
    },
    {
      "sqlstate": "44000",
      "class": "44",
      "class_name": "WITH CHECK OPTION Violation",
      "condition_name": "with_check_option_violation",
      "severity": "ERROR",
      "description": "WITH CHECK OPTION violation",
      "root_cause": "INSERT/UPDATE through view violates view's CHECK OPTION constraint",
      "remediation": "Ensure data satisfies view definition conditions; modify view definition if business logic changed; implement application-level validation matching view constraints",
      "common_scenarios": ["Upsert through filtered view", "Multi-layer view CHECK OPTION cascade", "Application unaware of view constraints"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "View usage audit; application-view contract validation"
    },
    {
      "sqlstate": "53000",
      "class": "53",
      "class_name": "Insufficient Resources",
      "condition_name": "insufficient_resources",
      "severity": "FATAL",
      "description": "Insufficient resources (generic)",
      "root_cause": "System resource exhaustion preventing operation completion",
      "remediation": "Identify exhausted resource (memory, disk, connections); increase resource limits; optimize resource usage; implement circuit breakers",
      "common_scenarios": ["Memory pressure", "Disk full", "Connection exhaustion"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Infrastructure capacity monitoring; proactive alerting"
    },
    {
      "sqlstate": "53100",
      "class": "53",
      "class_name": "Insufficient Resources",
      "condition_name": "disk_full",
      "severity": "FATAL",
      "description": "Disk full",
      "root_cause": "Filesystem containing PostgreSQL data directory or WAL files is full",
      "remediation": "Free disk space immediately; expand filesystem; implement disk space monitoring with 80%/90% thresholds; archive WAL files; tune autovacuum to reduce bloat",
      "common_scenarios": ["Unbounded table growth", "WAL accumulation during replica lag", "Autovacuum unable to keep up with churn", "Log file accumulation"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Immediate page; correlate with pg_stat_bgwriter, replication lag"
    },
    {
      "sqlstate": "53200",
      "class": "53",
      "class_name": "Insufficient Resources",
      "condition_name": "out_of_memory",
      "severity": "FATAL",
      "description": "Out of memory",
      "root_cause": "PostgreSQL backend or system exhausted available memory",
      "remediation": "Reduce work_mem for complex queries; implement query timeout; add system memory; tune shared_buffers; identify memory leak in extensions; monitor with pg_backend_memory_contexts",
      "common_scenarios": ["Large hash joins/spills", "Unbounded ARRAY_AGG", "Memory leak in C extension", "OOM killer terminating backends"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Immediate page; correlate with OS memory metrics, query patterns"
    },
    {
      "sqlstate": "53300",
      "class": "53",
      "class_name": "Insufficient Resources",
      "condition_name": "too_many_connections",
      "severity": "FATAL",
      "description": "Too many connections",
      "root_cause": "Active connections >= max_connections; connection pool misconfiguration; connection leak in application",
      "remediation": "Increase max_connections (with memory considerations); implement connection pooling (PgBouncer in transaction pooling mode); fix connection leaks; monitor with pg_stat_activity; set statement_timeout to kill idle connections",
      "common_scenarios": ["Connection pool max size > database max_connections", "Application not closing connections properly", "Sudden traffic spike", "Connection leak in ORM"],
      "rca_priority": "CRITICAL",
      "monitoring_recommendation": "Immediate alert; correlate with application metrics, connection churn rate"
    },
    {
      "sqlstate": "53400",
      "class": "53",
      "class_name": "Insufficient Resources",
      "condition_name": "configuration_limit_exceeded",
      "severity": "FATAL",
      "description": "Configuration limit exceeded",
      "root_cause": "Operation exceeded configured limit (e.g., max_locks_per_transaction, max_pred_locks_per_transaction)",
      "remediation": "Increase relevant GUC parameter; reduce transaction scope; avoid excessive locking patterns; monitor lock usage with pg_locks",
      "common_scenarios": ["Bulk DELETE/UPDATE on partitioned tables", "Excessive advisory locks", "Large transactions with many objects"],
      "rca_priority": "HIGH",
      "monitoring_recommendation": "Lock usage monitoring; transaction scope audit"
    },
    {
      "sqlstate": "54000",
      "class": "54",
      "class_name": "Program Limit Exceeded",
      "condition_name": "program_limit_exceeded",
      "severity": "ERROR",
      "description": "Program limit exceeded (generic)",
      "root_cause": "Operation exceeded internal PostgreSQL limits",
      "remediation": "Simplify operation; break into smaller units; increase relevant limits if safe",
      "common_scenarios": ["Deeply nested expressions", "Excessive recursion"],
      "rca_priority": "MEDIUM",
      "monitoring_recommendation": "Query complexity analysis"
    },
  {
  "sqlstate": "54001",
  "class": "54",
  "class_name": "Program Limit Exceeded",
  "condition_name": "statement_too_complex",
  "severity": "ERROR",
  "description": "Statement too complex",
  "root_cause": "Query planner exceeded internal complexity limits (e.g., expression depth, join combinations)",
  "remediation": "Simplify query structure; break into multiple statements with temp tables; increase max_expr_depth cautiously (risk of stack overflow); review query generation logic in ORMs",
  "common_scenarios": ["Auto-generated ORM queries with excessive joins", "Recursive CTEs with unbounded depth", "Dynamic query builders without complexity limits", "Pathological expression trees from nested functions"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "Query complexity metrics; flag queries exceeding planner thresholds"
},
{
  "sqlstate": "54011",
  "class": "54",
  "class_name": "Program Limit Exceeded",
  "condition_name": "too_many_columns",
  "severity": "ERROR",
  "description": "Too many columns",
  "root_cause": "Table definition exceeds MAX_COLUMS limit (1600 columns)",
  "remediation": "Normalize table schema; use JSONB/EAV pattern for sparse attributes; split wide tables into logical groups; avoid anti-patterns like entity-attribute-value without justification",
  "common_scenarios": ["Pivot operations creating wide tables", "Legacy system migrations with denormalized schemas", "Auto-generated schemas from unstructured data"],
  "rca_priority": "HIGH",
  "monitoring_recommendation": "Schema design review; column count monitoring during migrations"
},
{
  "sqlstate": "54023",
  "class": "54",
  "class_name": "Program Limit Exceeded",
  "condition_name": "too_many_arguments",
  "severity": "ERROR",
  "description": "Too many arguments",
  "root_cause": "Function/procedure call exceeds maximum argument limit (100 arguments)",
  "remediation": "Refactor function signature; use composite types or JSONB to pass structured data; split functionality into multiple functions",
  "common_scenarios": ["Legacy interface migrations", "Auto-generated wrapper functions", "Overly granular parameterization"],
  "rca_priority": "LOW",
  "monitoring_recommendation": "Function signature audit"
},
{
  "sqlstate": "55000",
  "class": "55",
  "class_name": "Object Not In Prerequisite State",
  "condition_name": "object_not_in_prerequisite_state",
  "severity": "ERROR",
  "description": "Object not in prerequisite state (generic)",
  "root_cause": "Operation attempted on object not in required state (e.g., index not valid, replica not synchronized)",
  "remediation": "Verify object state before operation; check pg_index.indisvalid for indexes; monitor replication lag for replicas",
  "common_scenarios": ["Querying invalid index during REINDEX", "Reading from replica with excessive lag", "Using materialized view before REFRESH"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "Object state monitoring; replication lag alerts"
},
{
  "sqlstate": "55006",
  "class": "55",
  "class_name": "Object Not In Prerequisite State",
  "condition_name": "object_in_use",
  "severity": "ERROR",
  "description": "Object in use",
  "root_cause": "DROP/ALTER attempted on table/index with active locks from other sessions",
  "remediation": "Terminate blocking sessions with pg_terminate_backend(); schedule maintenance during low-traffic periods; use ACCESS EXCLUSIVE lock timeout; implement lock wait monitoring",
  "common_scenarios": ["Schema migration during peak traffic", "Long-running queries blocking DDL", "Uncommitted transactions holding ACCESS SHARE locks", "Connection pool holding idle transactions"],
  "rca_priority": "HIGH",
  "monitoring_recommendation": "Lock contention monitoring; pg_locks analysis; maintenance window enforcement"
},
{
  "sqlstate": "55P02",
  "class": "55",
  "class_name": "Object Not In Prerequisite State",
  "condition_name": "cant_change_runtime_param",
  "severity": "ERROR",
  "description": "Cannot change runtime parameter",
  "root_cause": "Attempt to modify GUC parameter that requires restart or superuser privileges",
  "remediation": "Check parameter context (postmaster/sighup/superuser/user); modify postgresql.conf for restart-required params; use ALTER SYSTEM for dynamic params requiring reload",
  "common_scenarios": ["Application attempting to SET shared_buffers", "Non-superuser trying to modify log_statement", "Parameter context mismatch in connection pool"],
  "rca_priority": "LOW",
  "monitoring_recommendation": "GUC modification audit; privilege review"
},
{
  "sqlstate": "55P03",
  "class": "55",
  "class_name": "Object Not In Prerequisite State",
  "condition_name": "lock_not_available",
  "severity": "ERROR",
  "description": "Lock not available",
  "root_cause": "Requested lock could not be acquired within lock_timeout period",
  "remediation": "Increase lock_timeout for legitimate contention; implement retry logic with backoff; identify and eliminate lock contention hotspots; monitor pg_locks for blocking chains",
  "common_scenarios": ["High-concurrency updates on hot rows", "Long-running transactions holding locks", "Application retry storms exacerbating contention"],
  "rca_priority": "HIGH",
  "monitoring_recommendation": "Lock wait time monitoring; blocking session detection; deadlock prevention"
},
{
  "sqlstate": "55P04",
  "class": "55",
  "class_name": "Object Not In Prerequisite State",
  "condition_name": "unsafe_new_enum_value_usage",
  "severity": "ERROR",
  "description": "Unsafe new enum value usage",
  "root_cause": "New enum value used in transaction that might be serialized before enum alteration commits",
  "remediation": "Commit enum ALTER before using new value in concurrent transactions; avoid adding enum values during high concurrency; use check constraints with text instead of enums for volatile sets",
  "common_scenarios": ["Schema migration adding enum values under load", "Blue/green deployment with enum evolution"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "Enum modification audit; deployment coordination"
},
{
  "sqlstate": "57000",
  "class": "57",
  "class_name": "Operator Intervention",
  "condition_name": "operator_intervention",
  "severity": "ERROR",
  "description": "Operator intervention (generic)",
  "root_cause": "Database administrator manually intervened (e.g., canceled query, terminated backend)",
  "remediation": "Review pg_stat_activity for terminated sessions; check PostgreSQL logs for operator actions; implement query timeout policies to avoid manual intervention",
  "common_scenarios": ["DBA killing runaway query", "pg_cancel_backend() call from monitoring system", "Emergency maintenance"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "Operator action audit logging; query timeout automation"
},
{
  "sqlstate": "57014",
  "class": "57",
  "class_name": "Operator Intervention",
  "condition_name": "query_canceled",
  "severity": "ERROR",
  "description": "Query canceled",
  "root_cause": "Statement timeout (statement_timeout), idle_in_transaction_session_timeout, or manual cancel via pg_cancel_backend()",
  "remediation": "Optimize slow queries; increase timeout for legitimate long-running operations; implement query monitoring/alerting; use pg_stat_statements to identify problematic queries",
  "common_scenarios": ["Unoptimized analytical queries", "Missing indexes on filtered columns", "Ad-hoc queries from BI tools without timeout limits", "Connection pool idle timeout"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "Query duration monitoring; timeout policy enforcement; pg_stat_statements analysis"
},
{
  "sqlstate": "57P01",
  "class": "57",
  "class_name": "Operator Intervention",
  "condition_name": "admin_shutdown",
  "severity": "FATAL",
  "description": "Administrative shutdown",
  "root_cause": "PostgreSQL server shut down via pg_ctl stop, SIGTERM, or controlled restart",
  "remediation": "Implement connection retry logic with exponential backoff; use connection pooler with health checks; coordinate application deployments with DB maintenance windows",
  "common_scenarios": ["Planned maintenance", "Configuration reload requiring restart", "OS patching", "Cloud provider maintenance event"],
  "rca_priority": "CRITICAL",
  "monitoring_recommendation": "Immediate alert; correlate with infrastructure events; connection retry metrics"
},
{
  "sqlstate": "57P02",
  "class": "57",
  "class_name": "Operator Intervention",
  "condition_name": "crash_shutdown",
  "severity": "FATAL",
  "description": "Crash shutdown",
  "root_cause": "PostgreSQL server terminated abnormally (segfault, OOM kill, power loss)",
  "remediation": "Investigate OS/kernel logs for root cause; verify hardware health; check for extension bugs; implement HA/failover; review PostgreSQL logs for stack traces",
  "common_scenarios": ["Extension bug causing segfault", "System OOM killer terminating postgres", "Hardware failure", "Filesystem corruption"],
  "rca_priority": "CRITICAL",
  "monitoring_recommendation": "Immediate page; correlate with OS metrics; automatic failover verification"
},
{
  "sqlstate": "57P03",
  "class": "57",
  "class_name": "Operator Intervention",
  "condition_name": "cannot_connect_now",
  "severity": "FATAL",
  "description": "Cannot connect now",
  "root_cause": "Server in startup/shutdown/recovery state; not accepting connections",
  "remediation": "Wait for server to reach ready state; monitor pg_is_in_recovery(); implement connection retry with state awareness; check for recovery conflicts on replicas",
  "common_scenarios": ["Server startup after crash recovery", "Replica applying WAL during failover", "Promotion of standby to primary", "Archive recovery in progress"],
  "rca_priority": "CRITICAL",
  "monitoring_recommendation": "Server state monitoring; recovery progress tracking; connection retry with backoff"
},
{
  "sqlstate": "57P04",
  "class": "57",
  "class_name": "Operator Intervention",
  "condition_name": "database_crashed",
  "severity": "FATAL",
  "description": "Database crashed",
  "root_cause": "Specific database crashed due to corruption or critical error (rare)",
  "remediation": "Check PostgreSQL logs for corruption indicators; run pg_checksums verification; restore from backup if corruption confirmed; investigate storage subsystem health",
  "common_scenarios": ["Data page corruption from storage failure", "Filesystem metadata corruption", "Incomplete crash recovery"],
  "rca_priority": "CRITICAL",
  "monitoring_recommendation": "Immediate page; data integrity verification; restore procedure activation"
},
{
  "sqlstate": "57P05",
  "class": "57",
  "class_name": "Operator Intervention",
  "condition_name": "idle_session_timeout",
  "severity": "ERROR",
  "description": "Idle session timeout",
  "root_cause": "Session exceeded idle_session_timeout setting without activity",
  "remediation": "Adjust timeout based on application patterns; implement keepalive at application layer; fix connection pool leaks; monitor idle sessions with pg_stat_activity",
  "common_scenarios": ["Connection pool holding idle connections", "Interactive sessions left open", "Application bug leaking connections"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "Idle session monitoring; connection pool configuration audit"
},
{
  "sqlstate": "58000",
  "class": "58",
  "class_name": "System Error",
  "condition_name": "system_error",
  "severity": "FATAL",
  "description": "System error (generic)",
  "root_cause": "Operating system error affecting PostgreSQL operation",
  "remediation": "Check OS logs (/var/log/messages, dmesg); verify filesystem health; monitor hardware metrics; review PostgreSQL logs for syscall failures",
  "common_scenarios": ["Filesystem errors", "Network stack failures", "Resource limits (ulimit) exceeded", "SELinux/AppArmor denials"],
  "rca_priority": "CRITICAL",
  "monitoring_recommendation": "Infrastructure health correlation; OS log integration"
},
{
  "sqlstate": "58030",
  "class": "58",
  "class_name": "System Error",
  "condition_name": "io_error",
  "severity": "FATAL",
  "description": "I/O error",
  "root_cause": "Disk failure, filesystem full, permission denied, or hardware issue preventing PostgreSQL from reading/writing files",
  "remediation": "Check disk health (SMART); verify filesystem space (df -h); review OS logs (/var/log/messages); validate PostgreSQL data directory permissions; fail over to replica if primary storage failed",
  "common_scenarios": ["Disk full during WAL generation", "NFS mount failure", "Storage array controller failure", "Permission changes on data directory"],
  "rca_priority": "CRITICAL",
  "monitoring_recommendation": "Immediate page; disk space monitoring (80/90% thresholds); I/O error rate alerts"
},
{
  "sqlstate": "58P01",
  "class": "58",
  "class_name": "System Error",
  "condition_name": "undefined_file",
  "severity": "FATAL",
  "description": "Undefined file",
  "root_cause": "Referenced file (e.g., tablespace location, configuration file) does not exist or is inaccessible",
  "remediation": "Verify file paths in postgresql.conf; check tablespace symlinks; validate mount points; restore missing files from backup if critical",
  "common_scenarios": ["Tablespace mount point unmounted", "Configuration file deleted during upgrade", "Broken symlink in pg_tblspc"],
  "rca_priority": "CRITICAL",
  "monitoring_recommendation": "Filesystem mount monitoring; configuration drift detection"
},
{
  "sqlstate": "58P02",
  "class": "58",
  "class_name": "System Error",
  "condition_name": "duplicate_file",
  "severity": "FATAL",
  "description": "Duplicate file",
  "root_cause": "File creation failed due to existing file with same name in critical context",
  "remediation": "Investigate unexpected file presence; check for incomplete operations leaving artifacts; verify backup/restore procedures don't conflict with live files",
  "common_scenarios": ["Failed restore leaving partial files", "Manual file manipulation interfering with PostgreSQL", "Backup tool creating conflicting files"],
  "rca_priority": "HIGH",
  "monitoring_recommendation": "Filesystem integrity checks; backup/restore procedure validation"
},
{
  "sqlstate": "58P03",
  "class": "58",
  "class_name": "System Error",
  "condition_name": "missing_data_file",
  "severity": "FATAL",
  "description": "Missing data file",
  "root_cause": "Critical data file (e.g., relation file, WAL segment) missing from filesystem",
  "remediation": "Restore from backup immediately; investigate cause (manual deletion, filesystem corruption, incomplete restore); verify storage subsystem integrity",
  "common_scenarios": ["Accidental file deletion", "Filesystem corruption", "Incomplete base backup restore", "Storage array snapshot failure"],
  "rca_priority": "CRITICAL",
  "monitoring_recommendation": "Immediate page; file existence verification checks; backup validation"
},
{
  "sqlstate": "F0000",
  "class": "F0",
  "class_name": "Configuration File Error",
  "condition_name": "config_file_error",
  "severity": "FATAL",
  "description": "Configuration file error (generic)",
  "root_cause": "Syntax error or invalid value in postgresql.conf or related configuration files",
  "remediation": "Validate config syntax with pg_ctl config_check; review recent config changes; use version control for configuration; implement config change validation in CI/CD",
  "common_scenarios": ["Typo in GUC name/value", "Invalid unit specification (e.g., '10 mb' vs '10MB')", "Conflicting settings across config files (postgresql.conf, postgresql.auto.conf, ALTER SYSTEM)"],
  "rca_priority": "CRITICAL",
  "monitoring_recommendation": "Config change audit; pre-deployment validation; automatic rollback on failed reload"
},
{
  "sqlstate": "F0001",
  "class": "F0",
  "class_name": "Configuration File Error",
  "condition_name": "lock_file_exists",
  "severity": "FATAL",
  "description": "Lock file exists",
  "root_cause": "Postmaster lock file (postmaster.pid) exists but no running postmaster process detected",
  "remediation": "Verify no orphaned postgres processes exist (ps aux | grep postgres); safely remove postmaster.pid if confirmed stale; investigate cause of unclean shutdown",
  "common_scenarios": ["Unclean shutdown (kill -9, power loss)", "Manual deletion of postmaster.pid without stopping server", "Filesystem mount issues causing stale lock"],
  "rca_priority": "CRITICAL",
  "monitoring_recommendation": "Startup failure alert; process monitoring; unclean shutdown detection"
},
{
  "sqlstate": "HV000",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_error",
  "severity": "ERROR",
  "description": "Foreign data wrapper error (generic)",
  "root_cause": "Error in FDW operation (data source connectivity, protocol mismatch, FDW bug)",
  "remediation": "Check FDW-specific logs; verify remote data source availability; validate FDW configuration options; update FDW extension to latest version",
  "common_scenarios": ["Remote database unreachable", "Network firewall blocking FDW connection", "Schema drift in remote source", "FDW extension bug"],
  "rca_priority": "HIGH",
  "monitoring_recommendation": "FDW connection health checks; remote source availability monitoring"
},
{
  "sqlstate": "HV005",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_column_name_not_found",
  "severity": "ERROR",
  "description": "FDW column name not found",
  "root_cause": "Column referenced in FDW query does not exist in remote data source",
  "remediation": "Verify remote schema matches FDW definition; refresh FDW metadata with IMPORT FOREIGN SCHEMA or ALTER FOREIGN TABLE; handle schema evolution in remote source",
  "common_scenarios": ["Remote schema changed without FDW update", "Case sensitivity mismatch between PostgreSQL and remote source", "Column dropped in remote source"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "FDW schema drift detection; remote schema version tracking"
},
{
  "sqlstate": "HV002",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_dynamic_parameter_value_needed",
  "severity": "ERROR",
  "description": "FDW dynamic parameter value needed",
  "root_cause": "FDW requires parameter value not provided in query execution context",
  "remediation": "Provide required parameter via FDW options; check FDW documentation for required parameters; validate connection string/options",
  "common_scenarios": ["Missing authentication token for cloud FDW", "Required API key not configured", "Session parameter not propagated to FDW"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "FDW configuration validation"
},
{
  "sqlstate": "HV010",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_function_sequence_error",
  "severity": "ERROR",
  "description": "FDW function sequence error",
  "root_cause": "FDW API functions called in incorrect order (FDW implementation bug)",
  "remediation": "Update FDW extension to latest version; report bug to FDW maintainer; avoid problematic query patterns triggering bug",
  "common_scenarios": ["FDW extension bug", "Complex query patterns exposing FDW lifecycle issues"],
  "rca_priority": "HIGH",
  "monitoring_recommendation": "FDW extension version tracking; query pattern analysis"
},
{
  "sqlstate": "HV021",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_inconsistent_descriptor_information",
  "severity": "ERROR",
  "description": "FDW inconsistent descriptor information",
  "root_cause": "FDW metadata descriptors inconsistent with actual data source structure",
  "remediation": "Refresh FDW metadata; validate remote schema; check for FDW bugs in descriptor handling",
  "common_scenarios": ["Schema drift in remote source", "FDW bug in metadata caching", "Concurrent schema changes during query execution"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "FDW metadata freshness checks"
},
{
  "sqlstate": "HV024",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_invalid_attribute_value",
  "severity": "ERROR",
  "description": "FDW invalid attribute value",
  "root_cause": "Invalid value provided for FDW-specific option/attribute",
  "remediation": "Validate FDW option values against documentation; check for typos in option names/values; verify value ranges/formats",
  "common_scenarios": ["Invalid connection string parameter", "Out-of-range timeout value", "Unsupported authentication method"],
  "rca_priority": "LOW",
  "monitoring_recommendation": "FDW configuration validation"
},
{
  "sqlstate": "HV007",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_invalid_column_name",
  "severity": "ERROR",
  "description": "FDW invalid column name",
  "root_cause": "Column name violates remote data source naming rules",
  "remediation": "Use valid column names for remote source; quote identifiers if needed; avoid reserved words in remote system",
  "common_scenarios": ["Reserved word in remote database used as column name", "Special characters unsupported by remote source"],
  "rca_priority": "LOW",
  "monitoring_recommendation": "FDW naming convention audit"
},
{
  "sqlstate": "HV008",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_invalid_column_number",
  "severity": "ERROR",
  "description": "FDW invalid column number",
  "root_cause": "Column number reference invalid for remote data source",
  "remediation": "Verify column count in remote source; avoid hard-coded column positions; use column names instead of positions",
  "common_scenarios": ["Schema change altering column count", "Positional reference in FDW query after ALTER TABLE on remote"],
  "rca_priority": "LOW",
  "monitoring_recommendation": "FDW query pattern review"
},
{
  "sqlstate": "HV004",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_invalid_data_type",
  "severity": "ERROR",
  "description": "FDW invalid data type",
  "root_cause": "Data type not supported by FDW or remote data source",
  "remediation": "Use compatible data types; implement type casting at FDW level; avoid exotic types in FDW-mapped tables",
  "common_scenarios": ["PostgreSQL-specific type (e.g., tsvector) mapped to MySQL", "Geometry types with incompatible representations", "Custom types not available in remote source"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "FDW type compatibility audit"
},
{
  "sqlstate": "HV006",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_invalid_data_type_descriptors",
  "severity": "ERROR",
  "description": "FDW invalid data type descriptors",
  "root_cause": "Type descriptor metadata inconsistent between PostgreSQL and FDW",
  "remediation": "Update FDW extension; refresh FDW metadata; avoid complex type mappings",
  "common_scenarios": ["FDW bug in type descriptor handling", "Schema evolution with type changes"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "FDW extension version tracking"
},
{
  "sqlstate": "HV091",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_invalid_descriptor_field_identifier",
  "severity": "ERROR",
  "description": "FDW invalid descriptor field identifier",
  "root_cause": "Invalid field identifier in FDW descriptor structure",
  "remediation": "Update FDW extension; avoid edge-case query patterns triggering bug",
  "common_scenarios": ["FDW implementation bug", "Complex query exposing FDW internals"],
  "rca_priority": "LOW",
  "monitoring_recommendation": "FDW bug tracking"
},
{
  "sqlstate": "HV00B",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_invalid_handle",
  "severity": "ERROR",
  "description": "FDW invalid handle",
  "root_cause": "Invalid FDW connection/handle reference",
  "remediation": "Check FDW connection lifecycle; avoid reusing handles after closure; validate FDW state management",
  "common_scenarios": ["FDW bug in connection pooling", "Handle reuse after error", "Concurrent FDW operations corrupting state"],
  "rca_priority": "HIGH",
  "monitoring_recommendation": "FDW connection health monitoring"
},
{
  "sqlstate": "HV00C",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_invalid_option_index",
  "severity": "ERROR",
  "description": "FDW invalid option index",
  "root_cause": "Invalid index reference in FDW option array",
  "remediation": "Validate FDW option configuration; avoid manual manipulation of FDW catalogs",
  "common_scenarios": ["FDW bug in option handling", "Corrupted FDW catalog entries"],
  "rca_priority": "LOW",
  "monitoring_recommendation": "FDW configuration validation"
},
{
  "sqlstate": "HV00D",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_invalid_option_name",
  "severity": "ERROR",
  "description": "FDW invalid option name",
  "root_cause": "Option name not recognized by FDW",
  "remediation": "Verify option name against FDW documentation; check for typos; ensure FDW version supports option",
  "common_scenarios": ["Typo in FDW option name", "Option from newer FDW version used with older extension", "Deprecated option still in configuration"],
  "rca_priority": "LOW",
  "monitoring_recommendation": "FDW configuration validation"
},
{
  "sqlstate": "HV090",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_invalid_string_length",
  "severity": "ERROR",
  "description": "FDW invalid string length",
  "root_cause": "String value exceeds length limits imposed by FDW or remote source",
  "remediation": "Truncate values to FDW limits; validate input lengths; increase remote source limits if possible",
  "common_scenarios": ["Long identifiers exceeding remote system limits", "VARCHAR overflow in remote source"],
  "rca_priority": "LOW",
  "monitoring_recommendation": "Data length validation at ingestion"
},
{
  "sqlstate": "HV00A",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_invalid_string_format",
  "severity": "ERROR",
  "description": "FDW invalid string format",
  "root_cause": "String format not recognized by FDW or remote source",
  "remediation": "Validate string formats before FDW operations; use explicit formatting functions; avoid locale-specific formats",
  "common_scenarios": ["Date/time format mismatch", "Numeric format with locale-specific separators", "Encoding mismatch in string data"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "Data format validation"
},
{
  "sqlstate": "HV009",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_name_too_long",
  "severity": "ERROR",
  "description": "FDW name too long",
  "root_cause": "Identifier exceeds length limits of remote data source",
  "remediation": "Shorten identifiers; use abbreviations; avoid auto-generated long names",
  "common_scenarios": ["ORM-generated long constraint names", "Auto-generated index names from long column names"],
  "rca_priority": "LOW",
  "monitoring_recommendation": "Identifier length validation"
},
{
  "sqlstate": "HV014",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_null_value_not_allowed",
  "severity": "ERROR",
  "description": "FDW null value not allowed",
  "root_cause": "NULL value provided where remote source requires non-NULL",
  "remediation": "Validate for NULL before FDW operations; use COALESCE for defaults; implement application-level NULL handling",
  "common_scenarios": ["Remote NOT NULL constraint violated", "FDW option requiring non-NULL value"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "NULL validation at application layer"
},
{
  "sqlstate": "HV001",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_out_of_memory",
  "severity": "FATAL",
  "description": "FDW out of memory",
  "root_cause": "FDW operation exhausted available memory",
  "remediation": "Reduce FDW query complexity; limit result set sizes; increase memory limits; optimize FDW batch sizes",
  "common_scenarios": ["Large result sets from remote source", "FDW memory leak", "Unbounded array aggregation in FDW context"],
  "rca_priority": "CRITICAL",
  "monitoring_recommendation": "FDW memory usage monitoring; query size limits"
},
{
  "sqlstate": "HV00P",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_reply_handle",
  "severity": "ERROR",
  "description": "FDW reply handle",
  "root_cause": "FDW protocol reply handling error (FDW implementation specific)",
  "remediation": "Update FDW extension; check remote source logs; validate network stability for FDW connections",
  "common_scenarios": ["Network interruption during FDW operation", "Remote source protocol violation", "FDW bug in reply parsing"],
  "rca_priority": "HIGH",
  "monitoring_recommendation": "FDW connection stability monitoring"
},
{
  "sqlstate": "HV00J",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_schema_not_found",
  "severity": "ERROR",
  "description": "FDW schema not found",
  "root_cause": "Schema referenced in FDW operation does not exist in remote source",
  "remediation": "Verify remote schema exists; refresh FDW metadata; check case sensitivity in remote system",
  "common_scenarios": ["Schema dropped in remote source", "Case-sensitive schema name mismatch", "Permissions preventing schema visibility"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "Remote schema existence checks"
},
{
  "sqlstate": "HV00K",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_table_not_found",
  "severity": "ERROR",
  "description": "FDW table not found",
  "root_cause": "Table referenced in FDW operation does not exist in remote source",
  "remediation": "Verify remote table exists; refresh FDW metadata with IMPORT FOREIGN SCHEMA; check permissions on remote table",
  "common_scenarios": ["Table dropped in remote source", "Schema evolution without FDW update", "Permissions change on remote source"],
  "rca_priority": "HIGH",
  "monitoring_recommendation": "Remote table existence monitoring; FDW metadata freshness checks"
},
{
  "sqlstate": "HV00Q",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_too_many_handles",
  "severity": "ERROR",
  "description": "FDW too many handles",
  "root_cause": "FDW connection/handle limit exceeded",
  "remediation": "Implement FDW connection pooling; close unused handles; increase FDW handle limits if supported",
  "common_scenarios": ["Connection leak in FDW usage", "High concurrency overwhelming FDW limits", "Unclosed cursors in FDW context"],
  "rca_priority": "HIGH",
  "monitoring_recommendation": "FDW handle/connection count monitoring"
},
{
  "sqlstate": "HV00R",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_too_few_handles",
  "severity": "ERROR",
  "description": "FDW too few handles",
  "root_cause": "Insufficient FDW handles available for operation",
  "remediation": "Check for FDW handle leaks; validate FDW connection lifecycle; increase handle limits if supported",
  "common_scenarios": ["FDW bug in handle allocation", "Resource starvation in FDW context"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "FDW resource monitoring"
},
{
  "sqlstate": "HV00L",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_unable_to_create_execution",
  "severity": "ERROR",
  "description": "FDW unable to create execution",
  "root_cause": "FDW unable to initialize execution context for remote operation",
  "remediation": "Check remote source availability; validate FDW connection parameters; review FDW logs for initialization errors",
  "common_scenarios": ["Remote source unreachable", "Authentication failure for FDW connection", "FDW extension bug in execution setup"],
  "rca_priority": "HIGH",
  "monitoring_recommendation": "FDW connection health checks"
},
{
  "sqlstate": "HV00M",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_unable_to_create_reply",
  "severity": "ERROR",
  "description": "FDW unable to create reply",
  "root_cause": "FDW unable to construct reply from remote operation",
  "remediation": "Update FDW extension; check remote source response format; validate network stability",
  "common_scenarios": ["Malformed response from remote source", "FDW bug in reply construction", "Network corruption of FDW traffic"],
  "rca_priority": "HIGH",
  "monitoring_recommendation": "FDW response validation"
},
{
  "sqlstate": "HV00N",
  "class": "HV",
  "class_name": "Foreign Data Wrapper Error",
  "condition_name": "fdw_unable_to_establish_connection",
  "severity": "FATAL",
  "description": "FDW unable to establish connection",
  "root_cause": "FDW cannot connect to remote data source (network, auth, or availability issue)",
  "remediation": "Verify network connectivity to remote source; check firewall rules; validate credentials; monitor remote source health; implement FDW connection retry logic",
  "common_scenarios": ["Network partition", "Firewall blocking FDW port", "Remote database down", "Invalid credentials in FDW options", "DNS resolution failure"],
  "rca_priority": "CRITICAL",
  "monitoring_recommendation": "Immediate alert; correlate with remote source metrics; FDW connection pool health checks"
},
{
  "sqlstate": "P0000",
  "class": "P0",
  "class_name": "PL/pgSQL Error",
  "condition_name": "plpgsql_error",
  "severity": "ERROR",
  "description": "PL/pgSQL error (generic)",
  "root_cause": "Error within PL/pgSQL function/procedure execution",
  "remediation": "Review function source code; check EXCEPTION blocks; validate variable assignments and control flow",
  "common_scenarios": ["Logic error in function", "Missing exception handling", "Type mismatch in assignments"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "Function execution monitoring; error rate tracking"
},
{
  "sqlstate": "P0001",
  "class": "P0",
  "class_name": "PL/pgSQL Error",
  "condition_name": "raise_exception",
  "severity": "ERROR",
  "description": "RAISE EXCEPTION",
  "root_cause": "Explicit RAISE EXCEPTION statement executed in PL/pgSQL code",
  "remediation": "Review function logic triggering exception; validate business rule violations; check exception message for diagnostic details",
  "common_scenarios": ["Business rule validation failure", "Custom error handling in stored procedures", "Intentional error injection for testing"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "Application-level error tracking; exception pattern analysis"
},
{
  "sqlstate": "P0002",
  "class": "P0",
  "class_name": "PL/pgSQL Error",
  "condition_name": "no_data_found",
  "severity": "ERROR",
  "description": "No data found",
  "root_cause": "SELECT INTO or FETCH returned no rows in PL/pgSQL context",
  "remediation": "Handle NO_DATA_FOUND exception explicitly; validate query predicates; implement NOT FOUND check after SELECT INTO",
  "common_scenarios": ["Lookup by non-existent key", "Race condition where row deleted before fetch", "Incorrect WHERE clause in procedural code"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "Missing data pattern analysis; race condition detection"
},
{
  "sqlstate": "P0003",
  "class": "P0",
  "class_name": "PL/pgSQL Error",
  "condition_name": "too_many_rows",
  "severity": "ERROR",
  "description": "Too many rows",
  "root_cause": "SELECT INTO returned multiple rows where single row expected",
  "remediation": "Add LIMIT 1 with ORDER BY for deterministic selection; validate query uniqueness constraints; refactor to cursor if multiple rows expected",
  "common_scenarios": ["Non-unique lookup key", "Missing WHERE clause filter", "Schema change removing uniqueness constraint"],
  "rca_priority": "HIGH",
  "monitoring_recommendation": "Query uniqueness validation; schema change impact analysis"
},
{
  "sqlstate": "P0004",
  "class": "P0",
  "class_name": "PL/pgSQL Error",
  "condition_name": "assert_failure",
  "severity": "ERROR",
  "description": "ASSERT failure",
  "root_cause": "ASSERT statement condition evaluated to false",
  "remediation": "Review assertion logic; validate assumptions about data state; disable assertions in production if performance critical (plpgsql.check_asserts GUC)",
  "common_scenarios": ["Invariant violation in business logic", "Test assertion failing in production", "Race condition violating assumption"],
  "rca_priority": "MEDIUM",
  "monitoring_recommendation": "Assertion failure rate monitoring; invariant validation"
},
{
  "sqlstate": "XX000",
  "class": "XX",
  "class_name": "Internal Error",
  "condition_name": "internal_error",
  "severity": "PANIC",
  "description": "Internal error",
  "root_cause": "Unexpected internal error indicating PostgreSQL bug or severe corruption",
  "remediation": "Collect PostgreSQL logs and stack trace; report bug to PostgreSQL community with reproduction steps; restore from backup if corruption suspected; check hardware health (RAM/disk)",
  "common_scenarios": ["PostgreSQL version with known bug", "Memory corruption from faulty RAM", "Filesystem corruption affecting data files", "Extension bug causing backend crash"],
  "rca_priority": "CRITICAL",
  "monitoring_recommendation": "Immediate page; automatic failover trigger; hardware diagnostics"
},
{
  "sqlstate": "XX001",
  "class": "XX",
  "class_name": "Internal Error",
  "condition_name": "data_corrupted",
  "severity": "PANIC",
  "description": "Data corrupted",
  "root_cause": "Page checksum failure or other data integrity violation detected",
  "remediation": "Restore affected objects from backup; run pg_checksums to verify extent of corruption; investigate storage subsystem health; enable data checksums if not already active",
  "common_scenarios": ["Storage subsystem corruption", "Incomplete crash recovery", "Hardware memory error affecting writes", "Filesystem bug"],
  "rca_priority": "CRITICAL",
  "monitoring_recommendation": "Immediate page; automatic failover; checksum verification jobs"
},
{
  "sqlstate": "XX002",
  "class": "XX",
  "class_name": "Internal Error",
  "condition_name": "index_corrupted",
  "severity": "PANIC",
  "description": "Index corrupted",
  "root_cause": "Index structure integrity violation detected (e.g., btree page linkage broken)",
  "remediation": "REINDEX affected index immediately; investigate root cause (hardware issues, PostgreSQL bug); monitor for recurrence indicating systemic problem",
  "common_scenarios": ["Hardware memory error during index build", "PostgreSQL bug in index maintenance", "Filesystem corruption affecting index files"],
  "rca_priority": "CRITICAL",
  "monitoring_recommendation": "Index health checks; REINDEX automation for critical indexes; hardware diagnostics"
}
  ]
}
